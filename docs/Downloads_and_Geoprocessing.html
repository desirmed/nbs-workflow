<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Downloads and Geoprocessing</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Applied desirmed Framework</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="How_To.html">How to?</a>
</li>
<li>
  <a href="Download_Resources.html">Downloads</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.deltares.nl/en" target="_blank">
    <span> <img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/1.jpeg" alt="Organizational Logo" style="height: 45px;"></span>  
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Downloads and Geoprocessing</h1>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-02-28
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>nbs-workflow/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20241223code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20241223)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20241223code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20241223)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomOhmNpRtutorialtree8269de6daf1c8bc39768346e09500c2ba9f0ee76targetblank8269de6a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/deltares-desirmed/nbs-workflow/tree/8269de6daf1c8bc39768346e09500c2ba9f0ee76" target="_blank">8269de6</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomOhmNpRtutorialtree8269de6daf1c8bc39768346e09500c2ba9f0ee76targetblank8269de6a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/deltares-desirmed/nbs-workflow/tree/8269de6daf1c8bc39768346e09500c2ba9f0ee76" target="_blank">8269de6</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  analysis/Basic_Operations_with_Raster_Data.Rmd
    Untracked:  analysis/Resources.Rmd

Unstaged changes:
    Modified:   analysis/Understanding_Geospatial_Data.Rmd
    Modified:   analysis/_site.yml
    Deleted:    analysis/about.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/Downloads_and_Geoprocessing.Rmd</code>) and HTML
(<code>docs/Downloads_and_Geoprocessing.html</code>) files. If
you’ve configured a remote Git repository (see
<code>?wflow_git_remote</code>), click on the hyperlinks in the table
below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/deltares-desirmed/nbs-workflow/blob/8269de6daf1c8bc39768346e09500c2ba9f0ee76/analysis/Downloads_and_Geoprocessing.Rmd" target="_blank">8269de6</a>
</td>
<td>
Desmond Lartey
</td>
<td>
2025-01-31
</td>
<td>
wflow_publish("analysis/Downloads_and_Geoprocessing.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/deltares-desirmed/nbs-workflow/504b7c826c270d7bf5c65593289a7d953e7492e6/docs/Downloads_and_Geoprocessing.html" target="_blank">504b7c8</a>
</td>
<td>
Desmond Lartey
</td>
<td>
2025-02-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/deltares-desirmed/nbs-workflow/blob/d205c20c73b0a27838410db4625d2c9d84725aef/analysis/Downloads_and_Geoprocessing.Rmd" target="_blank">d205c20</a>
</td>
<td>
Desmond Lartey
</td>
<td>
2025-02-28
</td>
<td>
wflow_publish("analysis/Downloads_and_Geoprocessing.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/deltares-desirmed/nbs-workflow/c25291f5c7e4242c146b54e34b94af3fffdba1fc/docs/Downloads_and_Geoprocessing.html" target="_blank">c25291f</a>
</td>
<td>
Desmond Lartey
</td>
<td>
2025-02-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/deltares-desirmed/nbs-workflow/blob/69eb64021d01c11fe464a9b8f1a97afe7c9775f5/analysis/Downloads_and_Geoprocessing.Rmd" target="_blank">69eb640</a>
</td>
<td>
Desmond Lartey
</td>
<td>
2025-02-28
</td>
<td>
wflow_publish("analysis/Downloads_and_Geoprocessing.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/deltares-desirmed/nbs-workflow/c7cee438abde30017ba7d1c7dc44df42909dc05e/docs/Downloads_and_Geoprocessing.html" target="_blank">c7cee43</a>
</td>
<td>
Desmond Lartey
</td>
<td>
2025-02-28
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/deltares-desirmed/nbs-workflow/blob/2c2603bee94d3091b139555f7109c22c64114e76/analysis/Downloads_and_Geoprocessing.Rmd" target="_blank">2c2603b</a>
</td>
<td>
Desmond Lartey
</td>
<td>
2025-02-28
</td>
<td>
wflow_publish("analysis/Downloads_and_Geoprocessing.Rmd")
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<style> p { text-align: justify; } </style>


<style> p { text-align: justify; } </style>

<p>Functional units of the landscape form the basis for understanding and analyzing the interaction between natural and human systems. Land use and land cover data are critical in delineating these units, providing insights into spatial distribution, land patterns, and ecosystem functionality. The selection of appropriate datasets ensures accurate characterization and reliable impact assessments for Nature-based Solutions (NbS) portfolios.</p>

<div id="land-use-data" class="section level3">
<h3><strong>Land Use Data</strong></h3>
<p>Copernicus provides comprehensive datasets on land use at various scales and resolutions. These datasets are crucial for understanding spatial heterogeneity and characterizing landscape types. In this section, we focus on three primary datasets widely used for land use classification:</p>

<h4><strong>1. Urban Atlas</strong></h4>
<p>The Urban Atlas provides detailed land use data for Functional Urban Areas (FUAs) across Europe. This dataset is particularly useful for urban studies and planning. Although its spatial coverage is limited to urban zones, its high resolution (0.25 ha for urban and 1 ha for rural areas) makes it a preferred choice for fine-scale urban analyses.</p>
<ul>
<li>Dataset description: <a href="https://land.copernicus.eu/local/urban-atlas">Urban Atlas Overview</a></li>
<li>Download link: <a href="https://land.copernicus.eu/local/urban-atlas/access">Urban Atlas Data Access</a></li>
</ul>


<div style="background-color: #e6f2ff; padding: 15px; border-radius: 5px; border-left: 5px solid #008cba;">
  <strong>Note</strong>
  <p>The <strong>Urban Atlas 2018 dataset</strong> provides high-resolution land use and land cover data with population estimates for 788 Functional Urban Areas (FUAs) across Europe. It is ideal for urban planning and environmental assessments.</p>
</div>

<h4><strong>2. CORINE Land Cover (CLC)</strong></h4>
<p>Covering rural and urban areas, the CORINE dataset provides pan-European coverage with thematic detail spanning 44 land cover classes. This dataset is updated every six years and supports large-scale landscape analyses. While its resolution is coarser than Urban Atlas, CORINE excels in thematic coverage and integration of rural areas.</p>
<ul>
<li>Dataset description: <a href="https://land.copernicus.eu/pan-european/corine-land-cover">CORINE Land Cover Overview</a></li>
<li>Download link: <a href="https://land.copernicus.eu/pan-european/corine-land-cover/clc2018">CORINE Land Cover Data Access</a></li>
</ul>

<div style="background-color: #e6f2ff; padding: 15px; border-radius: 5px; border-left: 5px solid #008cba; margin-bottom: 10px;">
  <strong>Note</strong>
  <p>The <strong>CORINE Land Cover dataset</strong> provides a Europe-wide classification at 100m resolution. While useful for regional analysis, finer-scale studies may require high-resolution local datasets.</p>
</div>


<h4><strong>3. Coastal Zones</strong></h4>
<p>The Coastal Zones dataset focuses on detailed spatial coverage of coastal areas, which is essential for addressing coastal management and conservation needs. With a high resolution of 0.5 ha, this dataset supports precise delineation of coastal features and processes.</p>
<ul>
<li>Dataset description: <a href="https://land.copernicus.eu/local/coastal-zones">Coastal Zones Overview</a></li>
<li>Download link: <a href="https://land.copernicus.eu/local/coastal-zones/access">Coastal Zones Data Access</a></li>
</ul>

<div style="background-color: #e6f2ff; padding: 15px; border-radius: 5px; border-left: 5px solid #008cba; margin-bottom: 10px;">
  <strong>Note</strong>
  <p>The <strong>Coastal Land Use dataset</strong> is limited to a 10km inland buffer along the coastline. If your study area extends beyond this range, consider using other datasets that cover a broader region.</p>
</div>

<h4><strong>Comparison of Datasets</strong></h4>
<p>The table below provides a human-readable comparative overview of the three datasets:</p>

<table style="width:100%; border-collapse: collapse; text-align: left;">
<thead>
<tr style="border-bottom: 2px solid #ddd;">
<th style="padding: 8px;"><strong>Characteristic</strong></th>
<th style="padding: 8px;"><strong>Urban Atlas</strong></th>
<th style="padding: 8px;"><strong>CORINE Land Cover</strong></th>
<th style="padding: 8px;"><strong>Coastal Zones</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="padding: 8px;">Spatial Coverage</td>
<td style="padding: 8px;">Limited to FUAs</td>
<td style="padding: 8px;">Pan-European</td>
<td style="padding: 8px;">Focused on coastal areas</td>
</tr>
<tr>
<td style="padding: 8px;">Resolution</td>
<td style="padding: 8px;">High (0.25 ha urban, 1 ha rural)</td>
<td style="padding: 8px;">Moderate (25 ha for areal phenomena)</td>
<td style="padding: 8px;">High (0.5 ha)</td>
</tr>
<tr>
<td style="padding: 8px;">Thematic Detail</td>
<td style="padding: 8px;">17 urban and 10 rural classes</td>
<td style="padding: 8px;">44 thematic classes</td>
<td style="padding: 8px;">71 detailed classes</td>
</tr>
<tr>
<td style="padding: 8px;">Application</td>
<td style="padding: 8px;">Urban planning</td>
<td style="padding: 8px;">Broad landscape characterization</td>
<td style="padding: 8px;">Coastal zone management</td>
</tr>
</tbody>
</table>
<p>This table compares <strong>Urban Atlas, CORINE Land Cover, and Coastal Zones</strong> based on coverage, resolution, thematic detail, and application.</p>

<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/12.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>
<p>The <strong>Urban Atlas</strong> focuses on functional urban areas, <strong>CORINE</strong> provides broader land cover classifications, and <strong>Coastal Land Use</strong> highlights coastal zone features.</p>

<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/13.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>
<p>The <strong>Coastal dataset</strong> shows more artifacts, while the <strong>CORINE data</strong> lacks some level of detail, <a href="https://www.sciencedirect.com/science/article/pii/S1569843223002133?via%3Dihub">which are not very valid</a> for change analysis because of their associated errors and uncertainties. The CORINE layers of changes (CHA) remove a lot of these issues.</p>

<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/14.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>

<p>Based on the needs of this workflow, the Coastal Zones dataset will be used for further analyses due to its high resolution and relevance to coastal landscapes.</p>

<h4><strong>Step-by-Step Download and Processing</strong></h4>
<p>The following steps outline the process to download, inspect, and integrate the Coastal Zones dataset into the workflow:</p>

<h5><strong>Step 1: Visit the Copernicus Land use/cover Data Portal</strong></h5>
<p>Access the Coastal Zones dataset by visiting the <a href="https://land.copernicus.eu/local/coastal-zones">Copernicus Coastal Zones Portal</a>. Navigate to the data access section and select the relevant dataset.</p>

<h5><strong>Step 2: Select and Download the Dataset</strong></h5>
<p>Choose the required dataset based on the region and time period of interest. Follow the download instructions provided on the portal.</p>
<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/1.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>
<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/2.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>
<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/3.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>

<h5><strong>Step 3: Unzip and Inspect the Data</strong></h5>
<p>After downloading, unzip the dataset. You will realise that the dataset comes in different format, i.e the gpkg file and the qml for visualising. Add the gpkg file in QGIS or any prefered Dekstop GIS. I will use QGIS here.Inspect the spatial coverage and attributes. You can see that it has a redicoulsly large amount of shapes (>400,000). Once you load it, you can now add the qml file to visualise and inspect the various functional units. Before this, better zoom to your area of interest. We will not cover how to add the qml file to visualise the land use. For a hands-on guide on how to do it <a href="https://youtu.be/NEoVNalbajU?si=stcFFR6i_gYLtybJ" target="_blank">watch this video</a></p>
<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/4.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>
<p>Unzip the files and inspect it contents. </p>

<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/5.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>
<p>Add the layer to the map.</p>

<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/6.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>
<p>This can take a few minutes depending on your porcessor due to the file size. </p>
<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/7.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>
<div style="background-color: #e6f2ff; padding: 15px; border-radius: 5px; border-left: 5px solid #008cba;">
  <strong>Note</strong>
  <p>You can inspect the attributes of the dataset and take note of the columns available. For our Earth Engine processing, we will use the <strong>CODE_5_18</strong> column, as it contains the class values for the various land use categories.</p>
</div>
<p>If you follow the instruction in the video, you can add the qml file which contain the colors of the land use. You will notice that the land use/cover doesnt go beyond 10km from the coast.</p>
<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/8.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;" /></p>

<h5><strong>Step 4: Preprocess for Earth Engine</strong></h5>
<p>To do this in GEE,we will have to convert the dataset into a format compatible with Google Earth Engine (GEE), such as GeoTIFF or shapfiles. Use QGIS or a similar GIS tool for this step. Because the land use GPKG file contains a large number of shapes, which can make it cumbersome to work with in desktop software like ArcGIS, transitioning to a cloud computing platform like GEE is beneficial. These days, cloud platforms provide unparalleled processing power, scalability, and accessibility for handling large geospatial datasets, making them ideal for projects like this.

  GEE does not directly support GPKG files. Therefore, we need to export the data from GPKG into shapefiles, which are accepted by GEE. Shapefiles are more lightweight and manageable for this transition.</p>

<h5><strong>Step 5: Upload to Google Earth Engine</strong></h5>
<p>Log in to your Google Earth Engine (GEE) account and prepare to upload the preprocessed dataset. <a href="https://youtu.be/q-g9hLJHEcw?si=LbmgcU_jeCFKkD57">Learn how to open an Earth Engine account if you dont have</a>. Due to the large size and complexity of the dataset, especially when working with GPKG files containing a high number of shapes (e.g., >400,000), the geometry must be simplified and split to enhance performance. GEE imposes a limit on vertices for each feature, so splitting the geometry ensures that the upload is successful and the data renders efficiently. For this step, export your dataset from GPKG to Shapefile format, as GEE does not currently support GPKG files directly.</p>

<p>To upload your dataset:</p>
<ul>
  <li>Open the Asset Manager in the GEE Code Editor and click on the upload button (<strong>+</strong>).</li>
  <li>Select "Shape files" under the "Table Upload" section and navigate to your local Shapefile archive (.zip format) containing the .shp, .dbf, .shx, and .prj files.</li>
  <li>Specify an appropriate Asset ID and enable the "Split geometries" option under Advanced settings if the dataset contains highly detailed geometries.</li>
  <li>Click <strong>UPLOAD</strong> to start the process and monitor progress in the Task Manager.</li>
</ul>
<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/9.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>
<p>Because our vector file has more shapes than EE can handle, remember to check the 'split geometry' box. </p>

<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/10.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto;box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>

<div style="background-color: #e6f2ff; padding: 15px; border-radius: 5px; border-left: 5px solid #008cba;">
  <strong>Note</strong>
  <p>Ensure that only appropriate shapefile extensions are added. It is usually best to zip the entire folder containing the shapefiles and import it directly.</p>
</div>

<p>Cloud platforms like GEE provide unparalleled capabilities for processing and analyzing large geospatial datasets. These days, cloud computing is vital for handling big geospatial data because of its scalability, computational power, and ability to store and manage extensive datasets efficiently. GEE's integration with machine learning, visualization tools, and global datasets makes it an excellent choice for such workflows.</p>

<h5><strong>Step 6: Verify Dataset in GEE</strong></h5>
<p>After uploading, navigate to the Assets tab in the GEE Code Editor to ensure that the dataset appears as expected. Import the dataset into your script by copying the Asset ID and creating a FeatureCollection in your script:</p>
<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>
// Import the uploaded dataset
var landUseDataset = ee.FeatureCollection('users/your_username/your_asset_id');

// Display the dataset on the map
Map.centerObject(landUseDataset, 10); //You can comment out this part if your browser freezes or get an error like "Collection.geometry: Geometry has too many edges (13318505 > 2000000)."
Map.addLayer(landUseDataset, {}, 'Land Use Dataset');
</code></pre>
<p>We can now add the layer to the map</p>

<p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/11.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>
<p>Your layer should be like this. You can also adjust the color. Note that you have not yet added the class codes. We will treat that in the next section</p>

<h3><strong>Land Use Dataset Creation</strong></h3>
<p>The creation of land use datasets is an essential step in analyzing spatial patterns and understanding land cover dynamics over time. These datasets serve as foundational inputs for various geospatial analyses, including habitat classification, urban planning, and environmental monitoring. Using Earth Engine, we can load, process, and export land use datasets efficiently while ensuring compatibility with large-scale applications.</p>

<h4><strong>Step 1: Load Land Use Datasets</strong></h4>
<p>We start by loading the land use datasets for 2012 and 2018. These datasets provide detailed land cover information for Croatia, which will be analyzed for changes over time.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Load the assetar lulc2012 = ee.FeatureCollection('projects/ee-desmond/assets/lulc2012_Croatiafinal');
var lulc2018 = ee.FeatureCollection('projects/ee-desmond/assets/lulc2018_Croatiafinal');
</code>
</pre>

<p><strong>Explanation:</strong> The <code>ee.FeatureCollection</code> function is used to load the datasets. Each dataset contains land use features for Croatia, which are stored in a structured format compatible with Earth Engine operations.</p>

<h4><strong>Step 2: Define the Color Palette for Land Cover Classes</strong></h4>
<p>To enhance visualization, we define a color palette and descriptions for each land cover class. This ensures that each class is visually distinct and easy to interpret.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Define the color palette for each land use class
  var landCoverClasses = {
    11110: {color: '#d20000', description: 'Continuous urban fabric (IMD >= 80%)'},
    11120: {color: '#f20000', description: 'Dense urban fabric (IMD >= 30-80%)'},
    11130: {color: '#f5a18a', description: 'Low density fabric (IMD < 30%)'},
    11210: {color: '#9862f0', description: 'Industrial, commercial, public, and military units'},
    11220: {color: '#8748ee', description: 'Nuclear energy plants and associated land'},
    12100: {color: '#838b9d', description: 'Road networks and associated land'},
    12200: {color: '#404040', description: 'Railways and associated land'},
    12310: {color: '#ffe6de', description: 'Cargo port'},
    12320: {color: '#f0d7de', description: 'Passenger port'},
    12330: {color: '#FF1493', description: 'Fishing port'},
    12340: {color: '#800000', description: 'Naval port'},
    12350: {color: '#DB7093', description: 'Marinas'},
    12360: {color: '#9932CC', description: 'Local multi-functional harbours'},
    12370: {color: '#8B008B', description: 'Shipyards'},
    12400: {color: '#4B0082', description: 'Airports and associated land'},
    13110: {color: '#966401', description: 'Mineral extraction sites'},
    13120: {color: '#A52A2A', description: 'Dump sites'},
    13130: {color: '#B8860B', description: 'Construction sites'},
    13200: {color: '#D2691E', description: 'Land without current use'},
    14000: {color: '#91d700', description: 'Green urban, sports, and leisure facilities'},
    21100: {color: '#ffffa8', description: 'Arable irrigated and non-irrigated land'},
    21200: {color: '#b9c151', description: 'Greenhouses'},
    22100: {color: '#f3830b', description: 'Vineyards, fruit trees, and berry plantations'},
    22200: {color: '#df9f00', description: 'Olive groves'},
    23100: {color: '#ffe6a6', description: 'Annual crops associated with permanent crops'},
    23200: {color: '#ffe64d', description: 'Complex cultivation patterns'},
    23300: {color: '#e6cc4d', description: 'Land principally occupied by agriculture'},
    23400: {color: '#edc69f', description: 'Agro-forestry'},
    31100: {color: '#82be00', description: 'Natural & semi-natural broadleaved forest'},
    31200: {color: '#82be00', description: 'Highly artificial broadleaved plantations'},
    32100: {color: '#008000', description: 'Natural & semi-natural coniferous forest'},
    32200: {color: '#027800', description: 'Highly artificial coniferous plantations'},
    33100: {color: '#41a000', description: 'Natural & semi-natural mixed forest'},
    33200: {color: '#556B2F', description: 'Highly artificial mixed plantations'},
    34000: {color: '#a9f100', description: 'Transitional woodland and scrub'},
    35000: {color: '#8B0000', description: 'Lines of trees and scrub'},
    36000: {color: '#A0522D', description: 'Damaged forest'},
    41000: {color: '#BDB76B', description: 'Managed grassland'},
    42100: {color: '#DAA520', description: 'Semi-natural grassland'},
    42200: {color: '#F4A460', description: 'Alpine and sub-alpine natural grassland'},
    51000: {color: '#8B4513', description: 'Heathland and moorland'},
    52000: {color: '#DEB887', description: 'Alpine scrub land'},
    53000: {color: '#FFDAB9', description: 'Sclerophyllous scrubs'},
    61100: {color: '#D2B48C', description: 'Sparse vegetation on sands'},
    61200: {color: '#F5DEB3', description: 'Sparse vegetation on rocks'},
    62111: {color: '#FFE4C4', description: 'Sandy beaches'},
    62112: {color: '#FFA07A', description: 'Shingle beaches'},
    62120: {color: '#FFD700', description: 'Dunes'},
    62200: {color: '#FFEBCD', description: 'River banks'},
    63110: {color: '#FAF0E6', description: 'Bare rocks and outcrops'},
    63120: {color: '#F0E68C', description: 'Coastal cliffs'},
    63200: {color: '#D3D3D3', description: 'Burnt areas (except burnt forest)'},
    63300: {color: '#C0C0C0', description: 'Glaciers and perpetual snow'},
    71100: {color: '#B0E0E6', description: 'Inland marshes'},
    71210: {color: '#ADD8E6', description: 'Exploited peat bogs'},
    71220: {color: '#464af8', description: 'Unexploited peat bogs'},
    72100: {color: '#91c8f0', description: 'Salt marshes'},
    72200: {color: '#858fa7', description: 'Salines'},
    72300: {color: '#a2a3e3', description: 'Intertidal flats'},
    81100: {color: '#00f1dd', description: 'Natural & semi-natural water courses'},
    81200: {color: '#00f4cf', description: 'Highly modified water courses and canals'},
    81300: {color: '#79ecf0', description: 'Seasonally connected water courses'},
    82100: {color: '#82f0f0', description: 'Natural lakes'},
    82200: {color: '#78e6e6', description: 'Reservoirs'},
    82300: {color: '#6edcdc', description: 'Aquaculture ponds'},
    82400: {color: '#64d2d2', description: 'Standing water bodies of extractive industrial sites'},
    83100: {color: '#00ffa6', description: 'Lagoons'},
    83200: {color: '#00f096', description: 'Estuaries'},
    83300: {color: '#00e187', description: 'Marine inlets and fjords'},
    84100: {color: '#e6f5f3', description: 'Open sea'},
    84200: {color: '#d2e6eb', description: 'Coastal waters'}
  };
</code>
</pre>

<p><strong>Explanation:</strong> The <code>landCoverClasses</code> object maps class codes to their respective colors and descriptions. These properties are later used for styling the dataset in Earth Engine.</p>

<h4><strong>Step 3: Define Croatia Coastal Boundaries</strong></h4>
<p>We focus the analysis on Croatia's coastal region by defining a geographic boundary. This ensures that only relevant features are included in the dataset.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Define Croatia's coastal bounds
var croatiaCoastalBounds = ee.Geometry.Polygon([
  [13.5, 44.0], [18.5, 44.0], [18.5, 42.0], [13.5, 42.0], [13.5, 44.0]
]);
</code>
</pre>

<p><strong>Explanation:</strong> A polygon geometry is created to delineate the coastal region of Croatia. The <code>filterBounds</code> function will use this boundary to extract relevant features from the datasets.</p>

<h4><strong>Step 4: Filter the Dataset to the Coastal Region</strong></h4>
<p>The land use datasets are filtered to include only features within the coastal boundaries. This reduces computational overhead and focuses the analysis on the area of interest.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Filter datasets for 2012 and 2018 to the coastal region
var coastalLulc2012 = lulc2012.filterBounds(croatiaCoastalBounds);
var coastalLulc2018 = lulc2018.filterBounds(croatiaCoastalBounds);
</code>
</pre>

<p><strong>Explanation:</strong> The <code>filterBounds</code> method is used to extract features that intersect the defined coastal region. This step ensures that only relevant data is included in subsequent analyses.</p>

<h4><strong>Step 5: Rasterize the Dataset</strong></h4>
<p>We convert the feature collections into raster images, which are more suitable for pixel-based analyses and visualizations.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Rasterize the 2012 dataset
var rasterized2012 = coastalLulc2012.map(function(feature) {
  var code = feature.get('CODE_5_12'); // Use the field for the 2012 dataset
  return feature.set('class', code); // Set the class based on CODE_5_12
}).reduceToImage(['class'], ee.Reducer.first());

// Rasterize the 2018 dataset
var rasterized2018 = coastalLulc2018.map(function(feature) {
  var code = feature.get('CODE_5_18'); // Use the field for the 2018 dataset
  return feature.set('class', code); // Set the class based on CODE_5_18
}).reduceToImage(['class'], ee.Reducer.first());
</code>
</pre>

<p><strong>Explanation:</strong> The <code>reduceToImage</code> function is used to generate raster images from the feature collections. Each pixel in the raster represents a land use class, with values corresponding to the <code>class</code> property.</p>

<h4><strong>Step 6: Style and Visualize the Rasterized Datasets</strong></h4>
<p>We apply the color palette to the rasterized datasets and visualize them on the map for inspection.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Extract the color palette from landCoverClasses
var palette = Object.keys(landCoverClasses).map(function(key) {
  return landCoverClasses[key].color; // Ensure only colors are extracted
});

// Add the rasterized 2012 layer to the map
Map.addLayer(rasterized2012, {min: 11110, max: 84200, palette: palette}, 'Coastal Land Use 2012');

// Add the rasterized 2018 layer to the map
Map.addLayer(rasterized2018, {min: 11110, max: 84200, palette: palette}, 'Coastal Land Use 2018');
</code>
</pre>

<p><strong>Explanation:</strong> The color palette ensures that each class is visually distinct, making it easier to interpret the rasterized datasets. Adding the layers to the map allows for visual inspection and verification.</p>

<h4><strong>Step 7: Add a Legend for Visualization</strong></h4>
<p>To enhance interpretability, we create a legend that displays the color and description for each land use class.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Create the legend container
var legend = ui.Panel({
  style: {
    position: 'bottom-left',
    padding: '0px',
    backgroundColor: '#f0f0f0'
  }
});

// Add a checkbox to toggle the legend visibility
var showLegend = ui.Checkbox({
  label: 'Show Legend',
  value: true,  // Initially checked to show the legend
  style: {
    fontSize: '10px',
    padding: '0px',
    backgroundColor: '#f0f0f0'
  }
});
legend.add(showLegend);

// Create columns for the legend items
var column1 = ui.Panel({
  style: {
    padding: '5px',
    backgroundColor: '#f0f0f0'
  }
});

// Container panel to hold all columns
var columns = ui.Panel({
  layout: ui.Panel.Layout.Flow('horizontal'),
  style: {
    backgroundColor: '#f0f0f0'
  }
});
columns.add(column1);

// Helper function to create a legend row
var makeRow = function(color, description) {
  var colorBox = ui.Label({
    style: {
      backgroundColor: color,
      padding: '4px',
      margin: '0 4px 4px 0'
    }
  });
  var label = ui.Label({
    value: description,
    style: {
      margin: '0 0 4px 6px',
      fontSize: '10px',
      backgroundColor: '#f0f0f0'
    }
  });
  return ui.Panel({
    widgets: [colorBox, label],
    layout: ui.Panel.Layout.Flow('horizontal'),
    style: {
      backgroundColor: '#f0f0f0'
    }
  });
};

// Populate the legend
Object.keys(landCoverClasses).forEach(function(key) {
  var color = landCoverClasses[key].color;
  var description = landCoverClasses[key].description;
  column1.add(makeRow(color, description));
});

// Add the legend to the map
legend.add(columns);
Map.add(legend);
</code>
</pre>

<p><strong>Explanation:</strong> The legend provides a visual reference for interpreting the land use classes, making the map more user-friendly and informative.</p>

<h4><strong>Step 8: Export the Rasterized Datasets</strong></h4>
<p>Finally, we export the rasterized datasets as assets for further analysis or sharing.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Export rasterized 2012 dataset
Export.image.toAsset({
  image: rasterized2012,
  description: 'Coastal_Land_Use_2012',
  assetId: 'projects/ee-desmond/assets/Coastal_Land_Use_2012',
  region: croatiaCoastalBounds,
  scale: 30,
  crs: 'EPSG:4326',
  maxPixels: 1e13
});

// Export rasterized 2018 dataset
Export.image.toAsset({
  image: rasterized2018,
  description: 'Coastal_Land_Use_2018',
  assetId: 'projects/ee-desmond/assets/Coastal_Land_Use_2018',
  region: croatiaCoastalBounds,
  scale: 30,
  crs: 'EPSG:4326',
  maxPixels: 1e13
});
</code>
</pre>

<p><strong>Explanation:</strong> Exporting the datasets ensures that they are available for future analyses or integration into other workflows. The <code>Export.image.toAsset</code> function saves the data as assets within the Earth Engine environment.</p>

<p>Our Land use/cover data is ready for further analysis in Google Earth Engine. We will use this data as the functional unit and the basis for vreating other datasets like EUNIS, landscape Archetypes, Ecosystem service Map and risk exposures</p>

<h3><strong>Landscape Archetype Classification</strong></h3>
<p>Understanding landscape archetypes is a critical step in spatial analysis, providing insights into how different land use and land cover classes interact across a given region. The concept of landscape archetypes integrates bio-physical, socio-economic, and governance layers to create meaningful spatial patterns that aid in decision-making for environmental planning, impact assessments, and conservation strategies.</p>

<p>In this guide, we will develop a classification scheme for landscape archetypes i.e bio-physical using the land use dataset we created earlier. The workflow includes loading datasets, defining classifications, applying a reclassification technique, and visualizing the results. The classification process is based on CORINE land cover data, which serves as the basis for defining unique landscape archetypes according to their spatial patterns.</p>

<h4><strong>Step 1: Load Land Use Data</strong></h4>
<p>The first step involves loading the land use datasets for 2012 and 2018. These datasets will serve as the basis for reclassifying landscape archetypes.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Load the asset
var lulc2012 = ee.FeatureCollection('projects/ee-desmond/assets/lulc2012_Croatiafinal');
var lulc2018 = ee.FeatureCollection('projects/ee-desmond/assets/lulc2018_Croatiafinal');</code>
</pre>

<p><strong>Explanation:</strong> The <code>ee.FeatureCollection</code> function is used to load the vector datasets containing land use classifications for Croatia in 2012 and 2018. Each dataset consists of multiple features representing distinct land cover classes.</p>

<h4><strong>Step 2: Define Croatia’s Coastal Boundaries</strong></h4>
<p>To limit our analysis to the coastal region of Croatia, we define a geographic boundary using a polygon geometry.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Define Croatia's coastal bounds
var croatiaCoastalBounds = ee.Geometry.Polygon([
  [13.5, 44.0], [18.5, 44.0], [18.5, 42.0], [13.5, 42.0], [13.5, 44.0]
]);</code>
</pre>

<p><strong>Explanation:</strong> The <code>ee.Geometry.Polygon</code> function creates a polygon that defines the spatial extent of the study area. This boundary is later used to filter the dataset and extract only the relevant features.</p>

<h4><strong>Step 3: Filter the Dataset to the Coastal Region</strong></h4>
<p>Once the study boundary is established, we filter the dataset to retain only the features that fall within this region.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Filter the datasets to Croatia's coastal region
var coastalLulc2012 = lulc2012.filterBounds(croatiaCoastalBounds);
var coastalLulc2018 = lulc2018.filterBounds(croatiaCoastalBounds);</code>
</pre>

<p><strong>Explanation:</strong> The <code>filterBounds</code> method is applied to extract only those features that intersect with the defined polygon, ensuring that our analysis focuses solely on Croatia’s coastal areas.</p>

<h4><strong>Step 4: Define Landscape Archetypes</strong></h4>
<p>We define a classification scheme that groups land cover classes into broader landscape archetypes based on their ecological and functional similarities.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Define landscape archetypes
var landscapeArchetypes = {
// Urban: Highly urbanized areas including industrial, commercial, and residential zones.
'1': {
  classes: ['11110', '11120', '11130', '11210', '11220', '12100', '12200'],
  color: '#636363',
  description: 'Urban' // Includes continuous and dense urban fabric, low-density fabric, and industrial zones
},

// Coastal Urban: Urbanized areas near coastlines, including ports and airports.
'2': {
  classes: ['12310', '12320', '12330', '12340', '12350', '12360', '12370', '12400'],
  color: '#969696',
  description: 'Coastal Urban' // Includes cargo ports, passenger ports, fishing ports, naval ports, marinas, multifunctional harbours, shipyards, and airports
},

// Industrial: Areas heavily modified by human activity, including industrial sites and urban infrastructure.
'3': {
  classes: ['13110', '13120', '13130', '13200'],
  color: '#cccccc',
  description: 'Industrial' // Includes mineral extraction sites, dump sites, construction sites, and land without current use
},

// Recreational & Leisure Areas: Green urban spaces, parks, and leisure areas.
'4': {
  classes: ['14000'],
  color: '#91d700',
  description: 'Recreational & Leisure Areas' // Includes green urban areas and sports facilities
},

// Rural (Riparian Zone, Floodplain, Interfluvium Flat Areas): Agricultural and flat areas.
'5': {
  classes: ['21100', '21200', '23300', '23400'],
  color: '#91d700',
  description: 'Rural (Riparian Zone, Floodplain, Interfluvium Flat Areas)' // Includes arable land, greenhouses, agro-forestry, and semi-natural grasslands
},

// Rural (Hillside, Interfluvium Hilly Areas): Agricultural areas in hilly terrain.
'6': {
  classes: ['23100', '23200', '22200', '22100'],
  color: '#df9f00',
  description: 'Rural (Hillside, Interfluvium Hilly Areas)' // Includes annual crops, complex cultivation patterns, olive groves, and vineyards
},

// Forested: Predominantly forested areas with various tree species.
'7': {
  classes: ['31100', '31200', '31300', '32100', '32200', '33100', '33200', '34000'],
  color: '#80ff00',
  description: 'Forested' // Includes broad-leaved, coniferous, and mixed forests
},

// Mountainous (Hillside, Hollow/Torrent): Rugged terrains and sparsely vegetated regions.
'8': {
  classes: ['35000', '36000', '41000', '42100'],
  color: '#a63603',
  description: 'Mountainous (Hillside, Hollow/Torrent)' // Includes lines of trees, damaged forests, and sparsely vegetated areas
},

// Rural: Miscellaneous agricultural or low-density natural areas.
'9': {
  classes: ['42200', '51000', '52000', '53000', '61100'],
  color: '#78c679',
  description: 'Rural' // Includes heathland, scrubland, and sparse vegetation
},

// Coastal (Beach-Dune System, Coastal Land-Claim Areas): Sandy and reclaimed areas.
'10': {
  classes: ['62111', '62112', '62120', '61100'],
  color: '#ffcc99',
  description: 'Coastal (Beach-Dune System, Coastal Land-Claim Areas)' // Includes sandy beaches, shingle beaches, dunes, and bare rocks
},

// Coastal Rural (Estuary, Polder): Low-lying coastal and estuarine rural regions.
'11': {
  classes: ['62200', '63120', '63200'],
  color: '#7fff00',
  description: 'Coastal Rural (Estuary, Polder)' // Includes riverbanks, coastal cliffs, and burnt areas
},

// Wetlands & Marshes: Coastal and inland marshy areas.
'12': {
  classes: ['71100', '71210', '71220', '72100', '72200', '72300', '63300'],
  color: '#a6e6ff',
  description: 'Wetlands & Marshes' // Includes inland marshes, peat bogs, salt marshes, and intertidal flats
},

// Inland Water Bodies: Lakes, reservoirs, and water courses inland.
'13': {
  classes: ['81100', '81200', '81300', '82100', '82200', '82300', '82400'],
  color: '#4da6ff',
  description: 'Inland Water Bodies' // Includes lakes, reservoirs, aquaculture ponds, and water courses
},

// Marine (Subtidal Coast): Marine regions and coastal waters.
'14': {
  classes: ['83100', '83200', '83300', '84100', '84200'],
  color: '#00bfff',
  description: 'Marine (Subtidal Coast)' // Includes lagoons, estuaries, marine inlets, and coastal waters
}
};</code>
</pre>

<p><strong>Explanation:</strong> The <code>landscapeArchetypes</code> object maps groups of land cover codes to their corresponding archetypes. Each archetype is associated with a unique color and description to facilitate interpretation.</p>

<h4><strong>Step 5: Remap Land Cover Classes</strong></h4>
<p>To convert the original land cover classifications into archetypes, we create a mapping function that translates each class into its corresponding archetype.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Prepare lists for remapping
var fromList = [];
var toList = [];
var palette = [];
var descriptions = [];

Object.keys(landscapeArchetypes).forEach(function(archetypeId) {
  var archetype = landscapeArchetypes[archetypeId];
  var archetypeIdInt = parseInt(archetypeId);
  archetype.classes.forEach(function(classCode) {
    fromList.push(parseInt(classCode));
    toList.push(archetypeIdInt);
  });
  palette.push(archetype.color);
  descriptions.push(archetype.description);
});</code>
</pre>

<p><strong>Explanation:</strong> The <code>remap</code> function is used to convert the original land cover class values into landscape archetypes by replacing each class with its respective archetype ID. This step ensures that each pixel is assigned a meaningful category that aligns with the predefined archetype classification.</p>

<h4><strong>Step 6: Apply Reclassification</strong></h4>
<p>The final step involves reclassifying the 2012 and 2018 datasets based on the remapping criteria.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Reclassify the datasets
var codeImage2012 = coastalLulc2012.reduceToImage(['CODE_5_12'], ee.Reducer.first()).rename('code2012');
var codeImage2018 = coastalLulc2018.reduceToImage(['CODE_5_18'], ee.Reducer.first()).rename('code2018');

var archetypeImage2012 = codeImage2012.remap(fromList, toList).rename('archetype2012');
var archetypeImage2018 = codeImage2018.remap(fromList, toList).rename('archetype2018');</code>
</pre>

<p><strong>Explanation:</strong> Here you will realise we use 'CODE_5_12' and CODE_5_18' as columns to remap, this is because both datasets contains the class ids or class values to the land use. The <code>reduceToImage</code> function converts the vector dataset into a raster, while <code>remap</code> assigns each pixel a new value based on the archetype classification.</p>

<h4><strong>Technical Process Overview</strong></h4>

<ul>
  <li><strong>Data Preparation:</strong> The input datasets consist of land use classifications derived from CORINE data (2012 and 2018). Each land cover class is assigned a unique integer code.</li>
  
  <li><strong>Reclassification Using <code>remap()</code>:</strong> The <code>remap()</code> function is applied to translate CORINE land cover classes into predefined archetypes. Each archetype groups multiple land cover classes based on shared ecological and functional characteristics.</li>

  <li><strong>Binary Masking with <code>eq()</code> and <code>or()</code>:</strong> Pixel values are conditionally filtered to match the target landscape archetypes, ensuring that only relevant land cover types are included.</li>

  <li><strong>Rule-Based Aggregation:</strong> Similar land cover types (e.g., forests, agricultural lands) are grouped under broader landscape units to enhance interpretability and spatial generalization.</li>

  <li><strong>Vectorization and Area Computation:</strong> Raster data is converted into vector polygons, and each feature is assigned an area measurement to enable statistical assessments.</li>

  <li><strong>Visualization and Legend Creation:</strong> The reclassified maps are visualized using a predefined color palette, and a legend is dynamically generated to improve user interpretation.</li>

  <li><strong>Exporting Outputs:</strong> The final archetype datasets are exported to Google Earth Engine assets and Google Drive for further analysis and external use.</li>
</ul>

<h4><strong>Potential Issues and Considerations</strong></h4>

<ul>
  <li><strong>Loss of Granular Detail:</strong> Aggregating land cover classes into broad archetypes can obscure finer ecological variations (e.g., differentiating between mixed forests and coniferous forests).</li>

  <li><strong>Potential Misclassification:</strong> The binary classification approach using <code>eq()</code> and <code>or()</code> can lead to misclassification if a land cover pixel aligns with multiple archetypes (Panpan et al., 2024).</li>

  <li><strong>Landscape Artifacts and Temporal Mismatches:</strong> The underlying land cover dataset is based on 2018 data, meaning that landscape changes in the past six years are not reflected in the current classification (Sousa et al., 2020).</li>
</ul>

<h4><strong>References</strong></h4>

<ul>
  <li><a href="https://www.sciencedirect.com/science/article/pii/S0034425724003341">Panpan et al., 2024</a> - Comparative validation of recent 10 m-resolution global land cover maps.</li>
  <li><a href="https://www.researchgate.net/publication/343851866_Reconstructing_Three_Decades_of_Land_Use_and_Land_Cover_Changes_in_Brazilian_Biomes_with_Landsat_Archive_and_Earth_Engine">Sousa et al., 2020</a> - Reconstructing Three Decades of Land Use and Land Cover.</li>
</ul>

<p>For interactive visualization, explore the generated maps on <a href="https://desirmed.projects.earthengine.app/view/landscapearchetypes">Landscapearchetypes-biophysical</a>.</p>

<h5><strong>Other Datasets</strong></h5>
<p>Following the Biophysical archetypes, we will explore additional datasets such as EUNIS, Points of Interest (POI), population, river basins, hydrosheds, and flood probability data. Similar detailed steps will be provided to guide you through the download, preprocessing, and integration of these datasets.</p>
</div>


<h4><strong>Socio-Economic</strong></h2>

<p>
    Understanding landscapes extends beyond ecological and physical characteristics; 
    <strong>socio-economic factors</strong> play a crucial role in how landscapes function.  
    Socio-economic landscape characterization refers to analyzing human activities, economic infrastructures, 
    and demographics to assess their influence on land use, biodiversity, and resilience.
</p>

<p>
    Recent studies emphasize that integrating socio-economic data with landscape ecological analysis 
    enhances decision-making for <strong>Nature-Based Solutions (NBS)</strong> and sustainable land use planning  
    (<a href="https://www.tandfonline.com/doi/full/10.1080/10807039.2023.2267691" target="_blank">Zhang & Lin, 2023</a>;
    <a href="https://www.mdpi.com/2073-445X/13/4/529" target="_blank">Khoroshev & Emelyanova, 2024</a>).
</p>

<p>Mapping socio-economic indicators can include and not limited to: </p>
<ul>
    <li>Identify <strong>economic hubs and services</strong> influencing environmental pressures (<a href="https://www.mdpi.com/2071-1050/14/6/3447" target="_blank">Moos et al., 2022</a>).</li>
    <li>Analyze <strong>human-nature interactions</strong> affecting biodiversity conservation (<a href="https://www.frontiersin.org/journals/environmental-science/articles/10.3389/fenvs.2023.1112896/full" target="_blank">Morariu et al., 2023</a>).</li>
    <li>Support <strong>climate adaptation strategies</strong> by assessing economic vulnerability (<a href="https://doi.org/10.46609/ijsser.2024.v09i09.044" target="_blank">Edidin, 2024</a>).</li>
</ul>

<p>
    However, detailed socio-economic spatial data is often <strong>fragmented or inaccessible</strong>, 
    limiting its integration into landscape assessments at high resolution (<a href="https://doi.org/10.1111/gcb.15310" target="_blank">Nelson et al., 2020</a>).
</p>

<h4><strong>Using Foursquare’s POI Dataset for Socio-Economic indicators</strong></h3>
<p>
    Thanks to global location intelligence, we now have access to <strong>100 million+ Points of Interest (POI)</strong> from 
    <a href="https://www.fused.io/public/UDF_Foursquare_Open_Source_Places" target="_blank">Foursquare’s Open Source Places dataset</a>.
</p>

<p> Apart from for instances extracting socio-economic indicators from a land use data (which is often difficult), this is the most available dataset we can rely on. It is advisable to consult with stakeholders if these indicators align with what they will consider as receptors necessary for underdtanding their system  and the assessment and support of NbS. But we will use this dataset to:</p>
<ul>
    <li>Map <strong>economic activity and infrastructure</strong> (e.g., businesses, services, transport hubs).</li>
    <li>Assess <strong>functional land use</strong> and socio-economic interactions with ecological areas.</li>
    <li>Validate <strong>data with regional stakeholders</strong> to ensure relevance.</li>
</ul>

<h4><strong>Dataset Overview & Limitations</strong></h4>
<p>The dataset includes:</p>
<ul>
    <li><strong>Location metadata</strong> (e.g., coordinates, place names).</li>
    <li><strong>Hierarchical categorization</strong> (e.g., type of business or infrastructure).</li>
</ul>

<p>Example JSON of a POI:</p>
<pre>
{
  "type": "Feature",
  "properties": {
    "name": "Mauricio's Manor",
    "level2_category_name": "Accommodation"
  },
  "geometry": {
    "type": "Point",
    "coordinates": [-122.440572, 37.765877]
  }
}
</pre>

<h4><strong>Challenges & Limitations</strong></h4>
<ul>
    <li>Potential <strong>location inaccuracies</strong> (GPS shifts, outdated places).</li>
    <li><strong>Incomplete rural coverage</strong> (urban bias in data collection).</li>
    <li><strong>Categorization inconsistencies</strong> across different regions.</li>
</ul>

<h4><strong>Exploring, Downloading, and Preprocessing the Data</strong></h3>

<h4><strong>Step 1: Accessing Foursquare’s POI Data</strong></h4>
<ol>
    <li>We will first inspect how the POIS look like on a globe map.</li>
    <li>Go to <a href="https://opensource.foursquare.com/os-places/" target="_blank">Foursquare Open Source Places</a>.</li>
    <li>Click on Explore and then visualise pois.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/27.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>Now you can see how the data is visualise globally. You can display this differently by toggling betwwen the visualisation parameter. It was has a 2D and 3D map view.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/28.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>Thanks to Fused, they have partitioned these points into easily accessible GeoParquet files, and hosted them on <a href="https://source.coop/repositories/fused/fsq-os-places/description" target="_blank">Source Cooperative</a>. So we can easily extract this data for use.</li>
    <li>Go to <a href="https://www.fused.io/public/UDF_Foursquare_Open_Source_Places" target="_blank">Foursquare Open Source Places</a>.</li>
    <li>Search for your region of interest.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/29.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>Click on a POI to inspect its attributes.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/30.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
</ol>

<h4><strong>Inspecting a Point Feature in the Foursquare Dataset</strong></h4>

<p>
    After selecting a **Point of Interest (POI)** in the **Foursquare Open Source Places** interface,  
    the feature's details will appear in **JSON format** within the console.
</p>

<p>
    JSON (**JavaScript Object Notation**) is a lightweight data format used for storing and exchanging structured information.  
    In this dataset, each POI is represented as a **GeoJSON Feature**, containing **properties** (metadata) and **geometry** (location).
</p>

<p><strong>Example JSON Feature:</strong></p>

<pre style="background: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
{
  "type": "Feature",
  "properties": {
    "name": "Mauricio's Manor",
    "level2_category_name": "Accommodation"
  },
  "geometry": {
    "type": "Point",
    "coordinates": [-122.440572, 37.765877]
  }
}
</pre>

<p>
    To confirm if the extracted location matches the real-world coordinates or information we need to classify this KCS:
</p>

<ol>
    <li>Copy the entire **JSON feature** from the Foursquare console.</li>
    <li>Go to <a href="https://geojson.io" target="_blank"><strong>GeoJSON.io</strong></a>.</li>
    <li>Paste the copied **JSON feature** into the **right-side text editor**.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/31.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>The **location marker** will automatically appear on the interactive map. If you have idenfitied a another socio-economic data that you will want to map, copy that and paste</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/33.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
</ol>

<h4><strong>Inspecting the Point’s Accuracy</strong></h4>

<ul>
    <li>Toggle between <strong>Satellite and Street View</strong> to check if the POI is correctly positioned.</li>
    <li>Compare the **category and attributes** (e.g., business name) with known data.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/34.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>If the location appears incorrect, this suggests a **possible data quality issue** (e.g., outdated coordinates).</li>
</ul>

<p>
    This manual inspection helps verify **data reliability** before large-scale analysis.  For instance if the social economic indicator is positioned well, it attributes are correct and if you will like to consider this as a receptor.
    When you are satisfied with the information you have  a point, you can then export this and group them into the categories a.k.a Key Community Systems (KCS) useful for your assessment.
    However, since verifying thousands of points individually is impractical, we will use **spatial aggregation**  
    in the next step to analyze and group the pattern of these KCS at a broader scale.
</p>


<h4><strong>Understanding Aggregation in Spatial Analysis</strong></h3>
  <p>
    Spatial Aggregation calculates statistics in areas where an input layer overlaps a boundary layer. You can perform a spatial aggregate on maps with two layers: one area layer with the boundaries that will be used for aggregation (for example, countries, cities, districts or community) and one layer to aggregate.
    We will use area layers (in this case our community boundaries) to summarize only the proportions of the point features that are within the input boundary and group them into broader categories. So for instance, Health, Education etc. This helps us to know what categories of KCS are within a certain area which can be used for other exposure/vulnerability analysis. Remember that our poi data is already in categories.
  </p>
      <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/32.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
  <p>
      Imagine you have **100,000 individual KCS locations**. Instead of analyzing them **one by one**,  
      you can **aggregate** them by:
  </p>
  <ul>
      <li>Summing up **the number(count) of KCS in categories in each neighborhood**.</li>
      <li>Calculating **the average socio-economic density per region**.</li>
      <li>Grouping data **by categories** (e.g., commercial areas vs. residential zones).</li>
  </ul>

<p> To do this lets first download the data</p>

<h4><strong>Step 2: Downloading POI Data</strong></h4>
<ol>
    <li>Zoom into your area to capture detailed POI data.</li>
    <li>Click <strong>"Download Viewpoint"</strong>. It automatically download all poi on map canvas in **JSON format**.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/35.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>Save the downloaded data into a folder or directory.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/36.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>The next step now will be to convert the json file into a **shapefile** to be used in Earth Engine.</li>
</ol>

<h4><strong>Step 3: Converting JSON to Feature Class in ArcGIS Pro</strong></h4>
<ol>
    <li>Open **ArcGIS Pro**.</li>
    <li>Go to Analysis → Tools</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/37.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>And search for **"JSON to Features"*.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/38.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>Select the **downloaded JSON file** as input. And click run.By default, the geometry type is set to Polygon. Remember to change it to point </li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/39.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    <li>Export as **Shapefile (.shp)**.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/40.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>
    <li>You should now see your (.shp) poi data in where you saved it with other file extensions**.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/41.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
</ol>

<p> You can now import this data into earth engine for the spatial aggregation. You can consult previous guide to learn about how to import data into Earth engine as an asset.</p>
<p>
    Now that we have **ingested the data into Google Earth Engine (GEE)**,  
    we will proceed with **spatial aggregation** in the next section.
</p>

<h4><strong>Step 1: Spatial Aggregation of Points of Interest (POIs)</strong></h4>

<p>
    Now that we have **inspected and validated** the **Foursquare dataset**, we proceed to integrate  
    it with the **settlements dataset** using **spatial aggregation** in **Google Earth Engine (GEE)**.  
</p>


<p>
    In this step, we will **aggregate** POI data by their **category levels** into the **settlement boundaries**,  
    allowing us to assess how different **socioeconomic activities** are distributed.
</p>

<h4><strong>Step 2: Load the Required Datasets</strong></h4>

<p>
    The following script loads:
</p>

<ul>
    <li><strong>Settlement Boundaries:</strong> This dataset contains polygons representing **individual settlements**.</li>
    <li><strong>POI Dataset:</strong> This dataset contains **Points of Interest**, classified into **category levels**.</li>
</ul>

<pre style="background: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
// Load the settlements dataset
var settlements = ee.FeatureCollection("projects/ee-desmond/assets/desirmed/settlements_population_with_gender_age");

// Load the Point of Interest (POI) dataset
var poiDataset = ee.FeatureCollection('projects/ee-desmond/assets/desirmed/PointOfinterest');

// Print dataset structure
print(" Settlement Dataset:", settlements);
print(" POI Dataset:", poiDataset);
</pre>

<p>
    The **print() function** is used here to inspect the datasets before aggregation.  
    This ensures that the **attribute structure** and **geometries** are correct before proceeding.
</p>

<h4><strong>Step 3: Aggregating POIs into Settlements</strong></h4>

<p>
    The **aggregation process** involves the following steps:
</p>

<ol>
    <li>For each settlement, filter out **POIs that fall within its boundary**.</li>
    <li>Use the <code>aggregate_histogram()</code> function to count POIs by category.</li>
    <li>Add the aggregated counts as **new properties** to the settlement dataset.</li>
</ol>


<pre style="background: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
// Integrate POIs into settlements
var enhancedSettlementsWithPOI = settlements.map(function(feature) {
  // Filter POIs within the settlement boundary
  var poiInFeature = poiDataset.filterBounds(feature.geometry());
  
  // Aggregate POI data by Level 1 and Level 2 categories
  var level1Counts = poiInFeature.aggregate_histogram('level1_cat'); // Counts by Level 1 categories
  var level2Counts = poiInFeature.aggregate_histogram('level2_cat'); // Counts by Level 2 categories
  
  // Add the POI counts as new properties
  feature = feature.set('POI_Level1_Counts', level1Counts); // Add Level 1 POI counts
  feature = feature.set('POI_Level2_Counts', level2Counts); // Add Level 2 POI counts
  
  // Return the updated feature (with original attributes intact)
  return feature;
});

// Print an example feature to verify the aggregation
print(" Example Settlement with Aggregated POI Data:", enhancedSettlementsWithPOI.first());
</pre>

<ul>
    <li>The **<code>map()</code> function** loops over each settlement feature.</li>
    <li>The **<code>filterBounds()</code> function** extracts only the POIs that fall within the **settlement boundary**.</li>
    <li>The **<code>aggregate_histogram()</code> function** computes a **frequency count** of POIs per category.</li>
    <li>The **aggregated values** are stored as **new attributes** under:
        <ul>
            <li><code>POI_Level1_Counts</code>: High-level POI category counts (e.g., Food, Education).</li>
            <li><code>POI_Level2_Counts</code>: More detailed breakdown of POI categories (e.g., Restaurants, Schools).</li>
        </ul>
    </li>
</ul>


<p>
    Once the aggregation is complete, each **settlement feature** will contain new attributes  
    summarizing the type/categories of KCS and the **number of that per each category within its boundary**.
</p>

<p><strong>Example Output:</strong></p>

<pre style="background: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
{
  "type": "Feature",
  "properties": {
    "name": "Bruges",
    "population": 117000,
    "POI_Level1_Counts": {
      "Food & Drink": 125,
      "Education": 42,
      "Retail": 87
    },
    "POI_Level2_Counts": {
      "Restaurants": 89,
      "Cafes": 30,
      "Schools": 42,
      "Supermarkets": 50
    }
  },
  "geometry": { "type": "Polygon", "coordinates": [...] }
}
</pre>

<p>
    This output helps in **identifying economic hubs** within the landscape.  
    For example, a settlement with a **high density of restaurants and cafes** might indicate a **commercial center**,  
    while an area with **many schools and libraries** could represent an **educational zone**.
</p>


<p>
    This spatial aggregation allows us to **identify clusters of key community systems**  
    within each settlement, providing valuable insights into their **distribution and density**.  
    By analyzing these clusters, we can:
</p>

<ul>
    <li>Quantify the **availability and accessibility** of essential services within a given settlement.</li>
    <li>Evaluate the **exposure and vulnerability** of community assets to various environmental and socio-economic risks  
        through **overlay analysis** with hazard datasets.</li>
    <li>Assess how existing KCS can support or limit the **development and implementation of Nature-based Solutions (NbS)**  
        for climate resilience and urban planning.</li>
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/42.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>
</ul>


<h3><strong>EUNIS Dataset Creation</strong></h3>
<p>The <a href="https://eunis.eea.europa.eu/">EUNIS habitat classification system</a> is a vital tool for understanding habitat types across Europe, supporting biodiversity monitoring, conservation planning, and ecosystem-based management. By standardizing habitat classification, EUNIS provides a framework for consistent ecological assessments. To our knowledge, there isnt a unified EUNIS habitat map for the entire europe except smaller polygon shapes that exist as properties in other datasets. This is why we create one for the purpose of this study. While some EUNIS maps exist, they are often based on older datasets and may not reflect recent land use changes or provide adequate detail for dynamic regions.</p>

<p>Our workflow builds upon the foundational work conducted in the <a href="https://www.rest-coast.eu/">RESTCOAST project</a>. In Resct-coast, researchers used corine land cover data to derive EUNIS classifications using 1-to-1 tabular translation. But this create some limitations that we aim to address using a more detailed landuse/cover classes at higher resolution.</p>

<h4><strong>Shortcomings of the RESTCOAST Approach</strong></h4>
<ul>
  <li>**Outdated Classifications:** Reliance on classification code from 2012 limit the ability to capture recent habitats.</li>
  <li>**Overlapping Geometries:** Challenges in addressing overlapping polygons resulted in ambiguities in habitat delineations and area calculations.</li>
  <li>**Limited EUNIS Class Translation:** Not all available LULC classes were fully mapped to the comprehensive list of EUNIS habitat types, potentially leaving some habitats underrepresented.</li>
</ul>

<h4><strong>Improvements in This Workflow</strong></h4>
<p>To overcome these limitations, this workflow incorporates the following enhancements:</p>
<ul>
  <li>**Use of the detailed and higher resolution Datasets:** The 2018 coastal LULC datasets provide better alignment with current ecological realities and landscape changes.</li>
  <li>**Refined Crosswalk Mapping:** A complete translation table, including all 71 land use/cover types, ensures thorough and accurate habitat mapping. <a href="https://deltares-my.sharepoint.com/:x:/r/personal/desmond_lartey_deltares_nl/Documents/Desktop/DesirMED%20Work_Together/2%20Project%20Documents/3%20Landscape%20Characterisation%20ACTIONS/LandUse_to_EUNIS_Mapping.xlsx?d=w3e15aebd15e747e7ba1c2ab8e9754670&csf=1&web=1&e=Beb9Oy">Access the full translation table we developed here</a>.</li>
  <li>**Advanced Handling of Overlaps:** Overlapping geometries are resolved ensuring consistency in habitat delineation.</li>
  <li>**Scalability and Flexibility:** Leveraging GEE allows us to handle large datasets, perform complex spatial analyses, and generate high-resolution EUNIS maps dynamically.</li>
</ul>

<p>Our methodology ensures a more robust and comprehensive EUNIS dataset, addressing past limitations and providing better support for conservation efforts.</p>

<h4><strong>Land Use to EUNIS Crosswalk</strong></h4>
<p>To translate LULC data into EUNIS habitat types, a crosswalk table is employed. This table maps each LULC class to its corresponding EUNIS code, ensuring consistency and ecological relevance. Below is a snippet of the translation:</p>

<table style="width:100%; border-collapse: collapse; text-align: left;">
<thead>
<tr style="border-bottom: 2px solid #ddd;">
  <th style="padding: 8px; text-align: center;"><strong>Land Use Code</strong></th>
  <th style="padding: 8px; text-align: center;"><strong>Land Use Description</strong></th>
  <th style="padding: 8px; text-align: center;"><strong>EUNIS Numeric</strong></th>
  <th style="padding: 8px; text-align: center;"><strong>EUNIS Code</strong></th>
  <th style="padding: 8px; text-align: center;"><strong>EUNIS Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
  <td style="padding: 8px; text-align: center;">11110</td>
  <td style="padding: 8px;">Continuous urban fabric (IMD >= 80%)</td>
  <td style="padding: 8px; text-align: center;">1</td>
  <td style="padding: 8px; text-align: center;">J1</td>
  <td style="padding: 8px;">Buildings of cities, towns, and villages</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">11120</td>
  <td style="padding: 8px;">Dense urban fabric (IMD >= 30-80%)</td>
  <td style="padding: 8px; text-align: center;">2</td>
  <td style="padding: 8px; text-align: center;">J1.2</td>
  <td style="padding: 8px;">Residential buildings of villages and urban peripheries</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">11130</td>
  <td style="padding: 8px;">Low density fabric (IMD < 30%)</td>
  <td style="padding: 8px; text-align: center;">3</td>
  <td style="padding: 8px; text-align: center;">J2</td>
  <td style="padding: 8px;">Low density buildings</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">11210</td>
  <td style="padding: 8px;">Industrial, commercial, public, and military units</td>
  <td style="padding: 8px; text-align: center;">4</td>
  <td style="padding: 8px; text-align: center;">J4</td>
  <td style="padding: 8px;">Transport networks and other hard-surfaced areas</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">11220</td>
  <td style="padding: 8px;">Nuclear energy plants and associated land</td>
  <td style="padding: 8px; text-align: center;">5</td>
  <td style="padding: 8px; text-align: center;">J4.5</td>
  <td style="padding: 8px;">Hard-surfaced areas of ports</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">12100</td>
  <td style="padding: 8px;">Road networks and associated land</td>
  <td style="padding: 8px; text-align: center;">6</td>
  <td style="padding: 8px; text-align: center;">J4.4</td>
  <td style="padding: 8px;">Airport runways and aprons</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">12310</td>
  <td style="padding: 8px;">Cargo port</td>
  <td style="padding: 8px; text-align: center;">5</td>
  <td style="padding: 8px; text-align: center;">J4.5</td>
  <td style="padding: 8px;">Hard-surfaced areas of ports</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">12320</td>
  <td style="padding: 8px;">Passenger port</td>
  <td style="padding: 8px; text-align: center;">5</td>
  <td style="padding: 8px; text-align: center;">J4.5</td>
  <td style="padding: 8px;">Hard-surfaced areas of ports</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">31100</td>
  <td style="padding: 8px;">Agro-forestry</td>
  <td style="padding: 8px; text-align: center;">19</td>
  <td style="padding: 8px; text-align: center;">V6</td>
  <td style="padding: 8px;">Tree dominated man-made habitats</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">63200</td>
  <td style="padding: 8px;">Burnt areas (except burnt forest)</td>
  <td style="padding: 8px; text-align: center;">40</td>
  <td style="padding: 8px; text-align: center;">U5</td>
  <td style="padding: 8px;">Miscellaneous inland habitats usually with very sparse or no vegetation</td>
</tr>
<tr>
  <td style="padding: 8px; text-align: center;">84100</td>
  <td style="padding: 8px;">Open sea</td>
  <td style="padding: 8px; text-align: center;">57</td>
  <td style="padding: 8px; text-align: center;">MC5</td>
  <td style="padding: 8px;">Circalittoral sand</td>
</tr>
</tbody>
</table>

<p>Access the full list of <a href="https://eunis.eea.europa.eu/habitats-code-browser-revised.jsp?expand=#level_31916">EUNIS habitat classifications</a> for detailed descriptions and additional information on habitat types.</p>
<p>You can also access the <a href="https://deltares-my.sharepoint.com/:x:/r/personal/desmond_lartey_deltares_nl/_layouts/15/Doc.aspx?sourcedoc=%7B3E15AEBD-15E7-47E7-BA1C-2AB8E9754670%7D&file=LandUse_to_EUNIS_Mapping.xlsx&action=default&mobileredirect=true">full eunis tranlation code </a> for coastal areas here.</p>

<p>Some EUNIS codes repeat for different land use classes, such as port-related classes (e.g., cargo port, passenger port) mapping to J4.5. This repetition reflects the shared ecological characteristics of these land uses. However, it also underscores the need for careful validation to ensure that such overlaps do not introduce ambiguities into habitat assessments. From a special point of view, we have added a 2012 Eunis habitat map just to compare changes. This helps to also validate if a change of a classified eunis class make sense or not</p>

---

<h4><strong>Next Steps</strong></h4>
<p>We will proceed to outline the step-by-step process for creating a EUNIS habitat map.</p>

<h5><strong>Step 1: Define Land Cover Datasets</strong></h5>
<p>To start, we need to define the datasets that represent land cover for the years 2012 and 2018. These datasets will form the basis of our EUNIS habitat classification.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Define the land cover datasets
var landCoverYears = {
  '2012': ee.FeatureCollection('projects/ee-desmond/assets/lulc2012_Croatiafinal'),
  '2018': ee.FeatureCollection('projects/ee-desmond/assets/lulc2018_Croatiafinal')
};
</code>
</pre>

<p><strong>Explanation:</strong> This step initializes an object containing the FeatureCollections for the two datasets. Each dataset represents the land cover of Croatia for a specific year.</p>

<h5><strong>Step 2: Define the Crosswalk Mapping</strong></h5>
<p>In this step, we define how land cover classes from the datasets are translated into EUNIS habitat codes. This mapping is essential for accurate reclassification.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Define the crosswalk mapping from land cover classes to EUNIS habitats
  var landCoverToEunisNumeric = {
    11110: 1,  // J1 - Buildings of cities, towns, and villages
    11120: 2,  // J1.2 - Residential buildings of villages and urban peripheries
    11130: 3,  // J2 - Low density buildings
    11210: 4,  // J4 - Transport networks and other hard-surfaced areas
    11220: 5,  // J4.5 - Hard-surfaced areas of ports
    12100: 6,  // J4.4 - Airport runways and aprons
    12200: 7,  // J3 - Extractive industrial sites
    12310: 5,  // J4.5 - Hard-surfaced areas of ports
    12320: 5,  // J4.5 - Hard-surfaced areas of ports
    12330: 5,  // J4.5 - Hard-surfaced areas of ports
    12340: 5,  // J4.5 - Hard-surfaced areas of ports
    12350: 5,  // J4.5 - Hard-surfaced areas of ports
    12360: 5,  // J4.5 - Hard-surfaced areas of ports
    12370: 5,  // J4.5 - Hard-surfaced areas of ports
    12400: 6,  // J4.4 - Airport runways and aprons
    13110: 7,  // J3 - Extractive industrial sites
    13120: 8,  // J6 - Waste deposits
    13130: 9,  // J1.6 - Urban and suburban construction and demolition sites
    14000: 10,	//J2.6-2012	Disused rural constructions
    21100: 11,	//E2.6-2012'	Heavily fertilised grassland, including sports fields and grass lawns
    21200: 12,	//I1.1	Intensive unmixed crops
    22100: 13,	//J2.43-2012	Greenhouses
    22200: 14,	//V5	Shrub plantations
    23100: 15,	//T24	Olea europaea-Ceratonia siliqua forest
    23200: 16,	//	//B15	Bare tilled, fallow or recently abandoned arable land
    23300:	17,	//	V12	Mixed crops of market gardens and horticulture
    23400:	18,	//	V13	Arable land with unmixed crops grown by low-intensity agricultural methods
    31100:	19,	//	V6	Tree dominated man-made habitats
    31200:	20,	//	T1	Deciduous broadleaved forest
    31300:	21,	//	T29	Broadleaved evergreen plantation of non site-native trees
    32100:	22,	//	T3	Coniferous forest
    32200:	23,	//	T3N	Coniferous plantation of site-native trees
    33100:	24,	//	G4-2012	Mixed deciduous and coniferous woodland
    33200:  25,	//	G4.F-2012	Mixed forestry plantations
    34000:	26,	//	T41	Early-stage natural and semi-natural forest and regrowth
    35000:	27,	//	T42	Early-stage natural and semi-natural forest and regrowth
    36000:	28,	//	T43	Recently felled areas
    41000:	29,	//	V3	Artificial grasslands and herb dominated habitats
    42100:	30,	//	R2	Mesic grasslands
    42200:	31,	//	R4	Alpine and subalpine grasslands
    51000:	32,	//	S4	Temperate shrub heathland
    52000:	33,	//	S2	Arctic, alpine and subalpine scrub
    53000:	34,	//	F5	Maquis, arborescent matorral, and thermo-Mediterranean brushes
    61100:	35,	//	U2	Screes
    61200:	35,	//	U2	Screes
    62111:	36,	//	N1	Coastal dunes and sandy shores
    62112:	36,	//	N1	Coastal dunes and sandy shores
    62120:	37,	//	N14	Mediterranean, Macaronesian and Black Sea shifting coastal dune
    62200:	38,	//	C3.6-2012	Unvegetated or sparsely vegetated shores with soft or mobile sediments
    63110:	39,	//	U3	Inland cliffs, rock pavements and outcrops
    63120:	39,	//	U3	Inland cliffs, rock pavements and outcrops
    63200:	40,	//	U5	Miscellaneous inland habitats usually with very sparse or no vegetation
    63300:	41,	//	U4	Snow or ice-dominated habitats
    71100:	42,	//	D2-2012	Valley mires, poor fens and transition mires
    71210:	43,	//	D1	Raised and blanket bogs
    71220:	43,	//	D1	Raised and blanket bogs
    72100:	44,	//	MA2	Littoral biogenic habitat
    72200:	45,	//	J5.1	Highly artificial saline and brackish standing waters
    72300:	46,	//	MA5	Littoral sand
    81100:	47,	//	C2	Surface running waters
    81200:	48,	//	J5-2012	Highly artificial man-made waters and associated structures
    81300:	49,	//	C2.5-2012	Temporary running waters
    82100:	50,	//	C1	Surface standing waters
    82200:	51,	//	J5.3-2012	Highly artificial non-saline standing waters
    82300:	52,	//	J5.32-2012	Intensively managed fish ponds
    82400:	53,	//	J5.34-2013	Standing waterbodies of extractive industrial sites with extreme chemistry
    83100:	54,	//	X02-2012	Saline coastal lagoons
    83200:	55,	//	X01	Estuaries
    83300:	56,	//	MB1	Infralittoral rock
    84100:	57,	//	MC5	Circalittoral sand
    84200:	58,	//	MB5	Infralittoral sand
  
  
  };
</code>
</pre>

<p><strong>Explanation:</strong> This object maps numeric land cover codes to their corresponding EUNIS numeric codes. Each mapping represents a habitat type, allowing us to translate land cover data into the EUNIS classification system.</p>

<h5><strong>Step 3: Define the EUNIS Properties</strong></h5>
<p>Here, we assign properties like color and descriptions to EUNIS habitat types. This enhances visualization and understanding of the output.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Define the EUNIS properties mapping
  var eunisNumericMapping = {
    1: {eunisCode: 'J1', color: '#b22222', description: 'Buildings of cities, towns, and villages'}, // Deep red for urban areas
    2: {eunisCode: 'J1.2', color: '#ff4500', description: 'Residential buildings of villages and urban peripheries'}, // Orange-red
    3: {eunisCode: 'J2', color: '#ffa07a', description: 'Low density buildings'}, // Light coral for suburban areas
    4: {eunisCode: 'J4', color: '#8b4513', description: 'Transport networks and other hard-surfaced areas'}, // Saddle brown for roads
    5: {eunisCode: 'J4.5', color: '#d2691e', description: 'Hard-surfaced areas of ports'}, // Chocolate brown
    6: {eunisCode: 'J4.4', color: '#808080', description: 'Airport runways and aprons'}, // Gray for airstrips
    7: {eunisCode: 'J3', color: '#556b2f', description: 'Extractive industrial sites'}, // Dark olive green for industrial land
    8: {eunisCode: 'J6', color: '#a0522d', description: 'Waste deposits'}, // Sienna for waste areas
    9: {eunisCode: 'J1.6', color: '#d2b48c', description: 'Urban and suburban construction and demolition sites'}, // Tan
    10: {eunisCode: 'J2.6-2012', color: '#deb887', description: 'Disused rural constructions'}, // Burlywood
    11: {eunisCode: 'E2.6-2012', color: '#32cd32', description: 'Heavily fertilised grassland, including sports fields and grass lawns'}, // Lime green for managed grass
    12: {eunisCode: 'I1.1', color: '#adff2f', description: 'Intensive unmixed crops'}, // Green-yellow for intensive crops
    13: {eunisCode: 'J2.43-2012', color: '#ff7f50', description: 'Greenhouses'}, // Coral for greenhouses
    14: {eunisCode: 'V5', color: '#8fbc8f', description: 'Shrub plantations'}, // Dark sea green for shrubs
    15: {eunisCode: 'T24', color: '#228b22', description: 'Olea europaea-Ceratonia siliqua forest'}, // Forest green
    16: {eunisCode: 'B15', color: '#f4a460', description: 'Bare tilled, fallow or recently abandoned arable land'}, // Sandy brown
    17: {eunisCode: 'V12', color: '#ffe4b5', description: 'Mixed crops of market gardens and horticulture'}, // Moccasin
    18: {eunisCode: 'V13', color: '#f0e68c', description: 'Arable land with unmixed crops grown by low-intensity agricultural methods'}, // Khaki
    19: {eunisCode: 'V6', color: '#6b8e23', description: 'Tree dominated man-made habitats'}, // Olive drab
    20: {eunisCode: 'T1', color: '#008000', description: 'Deciduous broadleaved forest'}, // Green for forest
    21: {eunisCode: 'T29', color: '#2e8b57', description: 'Broadleaved evergreen plantation of non site-native trees'}, // Sea green
    22: {eunisCode: 'T3', color: '#3cb371', description: 'Coniferous forest'}, // Medium sea green
    23: {eunisCode: 'T3N', color: '#66cdaa', description: 'Coniferous plantation of site-native trees'}, // Medium aquamarine
    24: {eunisCode: 'G4-2012', color: '#20b2aa', description: 'Mixed deciduous and coniferous woodland'}, // Light sea green
    25: {eunisCode: 'G4.F-2012', color: '#5f9ea0', description: 'Mixed forestry plantations'}, // Cadet blue
    26: {eunisCode: 'T41', color: '#4682b4', description: 'Early-stage natural and semi-natural forest and regrowth'}, // Steel blue
    27: {eunisCode: 'T42', color: '#87cefa', description: 'Early-stage natural and semi-natural forest and regrowth'}, // Light sky blue
    28: {eunisCode: 'T43', color: '#d3d3d3', description: 'Recently felled areas'}, // Light gray
    29: {eunisCode: 'V3', color: '#7cfc00', description: 'Artificial grasslands and herb dominated habitats'}, // Lawn green
    30: {eunisCode: 'R2', color: '#006400', description: 'Mesic grasslands'}, // Dark green
    31: {eunisCode: 'R4', color: '#556b2f', description: 'Alpine and subalpine grasslands'}, // Dark olive green
    32: {eunisCode: 'S4', color: '#8b0000', description: 'Temperate shrub heathland'}, // Dark red
    33: {eunisCode: 'S2', color: '#00008b', description: 'Arctic, alpine, and subalpine scrub'}, // Dark blue
    34: {eunisCode: 'F5', color: '#b0c4de', description: 'Maquis, arborescent matorral, and thermo-Mediterranean brushes'}, // Light steel blue
    35: {eunisCode: 'U2', color: '#708090', description: 'Screes'}, // Slate gray
    36: {eunisCode: 'N1', color: '#fa8072', description: 'Coastal dunes and sandy shores'}, // Salmon
    37: {eunisCode: 'N14', color: '#f08080', description: 'Mediterranean, Macaronesian and Black Sea shifting coastal dune'}, // Light coral
    38: {eunisCode: 'C3.6-2012', color: '#add8e6', description: 'Unvegetated or sparsely vegetated shores with soft or mobile sediments'}, // Light blue
    39: {eunisCode: 'U3', color: '#dda0dd', description: 'Inland cliffs, rock pavements and outcrops'}, // Plum
    40: {eunisCode: 'U5', color: '#ba55d3', description: 'Miscellaneous inland habitats usually with very sparse or no vegetation'}, // Medium orchid
    41: {eunisCode: 'U4', color: '#9400d3', description: 'Snow or ice-dominated habitats'}, // Dark violet
    42: {eunisCode: 'D2-2012', color: '#00ced1', description: 'Valley mires, poor fens and transition mires'}, // Dark turquoise
    43: {eunisCode: 'D1', color: '#4682b4', description: 'Raised and blanket bogs'}, // Steel blue
    44: {eunisCode: 'MA2', color: '#6495ed', description: 'Littoral biogenic habitat'}, // Cornflower blue
    45: {eunisCode: 'J5.1', color: '#1e90ff', description: 'Highly artificial saline and brackish standing waters'}, // Dodger blue
    46: {eunisCode: 'MA5', color: '#ffdab9', description: 'Littoral sand'}, // Peach puff
    47: {eunisCode: 'C2', color: '#4169e1', description: 'Surface running waters'}, // Royal blue
    48: {eunisCode: 'J5-2012', color: '#8b0000', description: 'Highly artificial man-made waters and associated structures'}, // Dark red
    49: {eunisCode: 'C2.5-2012', color: '#5f9ea0', description: 'Temporary running waters'}, // Cadet blue
    50: {eunisCode: 'C1', color: '#00bfff', description: 'Surface standing waters'}, // Deep sky blue
    51: {eunisCode: 'J5.3-2012', color: '#1e90ff', description: 'Highly artificial non-saline standing waters'}, // Dodger blue
    52: {eunisCode: 'J5.32-2012', color: '#ff4500', description: 'Intensively managed fish ponds'}, // Orange-red
    53: {eunisCode: 'J5.34-2013', color: '#228b22', description: 'Standing waterbodies of extractive industrial sites with extreme chemistry'}, // Forest green
    54: {eunisCode: 'X02-2012', color: '#87ceeb', description: 'Saline coastal lagoons'}, // Sky blue
    55: {eunisCode: 'X01', color: '#00008b', description: 'Estuaries'}, // Dark blue
    56: {eunisCode: 'MB1', color: '#6baed6', description: 'Infralittoral rock'}, // Steel blue
    57: {eunisCode: 'MC5', color: '#e6f2ff', description: 'Circalittoral sand'}, // Blue violet
    58: {eunisCode: 'MB5', color: '#2171b5', description: 'Infralittoral sand'} // Light steel blue
  };
</code>
</pre>

<p><strong>Explanation:</strong> Each EUNIS code is assigned a color and description. This is useful for visualization and interpretation of the classified datasets.</p>

<h5><strong>Step 4: Reclassify Land Cover to EUNIS</strong></h5>
<p>Now, we write a function to reclassify the land cover dataset into EUNIS habitats based on the mapping we defined earlier.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Function to reclassify land cover data into EUNIS numeric codes
var reclassifyToEunis = function(dataset, codeField, mapping) {
  var mappingKeys = Object.keys(mapping).map(Number); // Input land cover class codes as numbers
  var mappingValues = Object.keys(mapping).map(function(key) {
    return mapping[key]; // Extract corresponding EUNIS numeric codes
  });

  return dataset.remap(
    mappingKeys,  // CORINE codes as input
    mappingValues // Corresponding EUNIS numeric codes
  );
};
</code>
</pre>

<p><strong>Explanation:</strong> This function accepts a dataset, a code field, and the mapping object. It uses the <code>remap</code> function to reclassify the dataset based on the mapping.</p>

<h5><strong>Step 5: Visualize the Reclassified Dataset</strong></h5>
<p>We create another function to style the reclassified EUNIS image for visualization in Google Earth Engine.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Function to style the reclassified EUNIS image
var styleEunisImage = function(image) {
  var palette = Object.keys(eunisNumericMapping).map(function(key) {
    return eunisNumericMapping[key].color; // Extract EUNIS color values
  });

  return image.visualize({
    min: 1,
    max: 58, // Adjust range based on EUNIS numeric codes
    palette: palette // Apply palette for EUNIS visualization
  });
};
</code>
</pre>

<p><strong>Explanation:</strong> This function applies a color palette to the reclassified dataset for better visualization. The palette is derived from the EUNIS properties defined earlier.</p>

<h5><strong>Step 6: Define Croatia Coastal Boundaries</strong></h5>
<p>We define the geographic bounds of Croatia's coastal regions to limit the analysis to the relevant area.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Define Croatia's coastal bounds
var croatiaCoastalBounds = ee.Geometry.Polygon([
  [13.5, 44.0], [18.5, 44.0], [18.5, 42.0], [13.5, 42.0], [13.5, 44.0]
]);
</code>
</pre>

<p><strong>Explanation:</strong> This polygon defines the region of interest, focusing the analysis on Croatia's coastal area and excluding inland or irrelevant regions.</p>

<h5><strong>Step 7: Reclassify and Style the 2012 Dataset</strong></h5>
<p>Using the reclassification and visualization functions, we process the 2012 land cover dataset.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Reclassify and style 2012 dataset
var reclassified2012 = reclassifyToEunis(
  landCoverYears['2012'].filterBounds(croatiaCoastalBounds).reduceToImage(['CODE_5_12'], ee.Reducer.first()),
  'CODE_5_12',
  landCoverToEunisNumeric
);

Map.addLayer(reclassified2012, {
  min: 1,
  max: 58,
  palette: Object.keys(eunisNumericMapping).map(function(key) {
    return eunisNumericMapping[key].color;
  })
}, 'EUNIS 2012');
</code>
</pre>

<p><strong>Explanation:</strong> This step filters, reclassifies, and visualizes the 2012 dataset for Croatia's coastal regions.</p>

<h5><strong>Step 8: Reclassify and Style the 2018 Dataset</strong></h5>
<p>We repeat the process for the 2018 dataset, ensuring consistency in approach and visualization.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
<code>// Reclassify and style 2018 dataset
var reclassified2018 = reclassifyToEunis(
  landCoverYears['2018'].filterBounds(croatiaCoastalBounds).reduceToImage(['CODE_5_18'], ee.Reducer.first()),
  'CODE_5_18',
  landCoverToEunisNumeric
);

Map.addLayer(reclassified2018, {
  min: 1,
  max: 58,
  palette: Object.keys(eunisNumericMapping).map(function(key) {
    return eunisNumericMapping[key].color;
  })
}, 'EUNIS 2018');
</code>
</pre>

<p><strong>Explanation:</strong> The 2018 dataset is processed in the same way, enabling direct comparison with the 2012 dataset.</p>

<p>Now that the 2018 dataset is visualized, comparisons between 2012 and 2018 are possible.</p>

<h5><strong>Step 9: Create a Chart for Comparing EUNIS Areas</h5>strong></strong></h5>
<p><strong>Explanation:</strong> Comparing habitat areas across years provides insights into ecological changes. This is done by computing areas of each EUNIS class and displaying them in bar and pie charts for better visualization.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"><code>// Function to compute EUNIS areas
var computeEunisAreas = function(image, year, geometry) {
  var areaImage = ee.Image.pixelArea().divide(1e6).addBands(image.rename('class')); // Area in km²
  var areas = areaImage.reduceRegion({
    reducer: ee.Reducer.sum().group({
      groupField: 1,
      groupName: 'class'
    }),
    geometry: geometry,
    scale: 100,
    maxPixels: 1e13
  });
  return ee.List(areas.get('groups')).map(function(item) {
    var areaDict = ee.Dictionary(item);
    return ee.Feature(null, {
      'class': ee.Number(areaDict.get('class')),
      'area': ee.Number(areaDict.get('sum')),
      'year': year
    });
  });
};</code></pre>

<p>The computed areas for both 2012 and 2018 datasets are visualized in a bar chart for direct comparison.</p>

<h5><strong>Step 10: Export the Reclassified Data</strong></h5>
<p><strong>Explanation:</strong> To facilitate further analysis or sharing, the reclassified datasets for 2012 and 2018 are exported in raster and vector formats. These exports allow users to inspect and validate the data in desktop GIS tools.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"><code>// Export reclassified 2018 dataset as raster
Export.image.toDrive({
  image: reclassified2018,
  description: 'EUNIS_2018_TIFF',
  fileNamePrefix: 'EUNIS_2018_TIFF',
  region: croatiaCoastalBounds,
  scale: 30,
  crs: 'EPSG:4326',
  maxPixels: 1e13
});</code></pre>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"><code>// Export reclassified 2018 dataset as vector
var vectorEunis2018 = reclassified2018.reduceToVectors({
  geometryType: 'polygon',
  reducer: ee.Reducer.countEvery(),
  scale: 30,
  maxPixels: 1e13,
  geometry: croatiaCoastalBounds
});

Export.table.toDrive({
  collection: vectorEunis2018,
  description: 'EUNIS_2018_Shapefile',
  fileFormat: 'SHP',
  folder: 'GEE',
  fileNamePrefix: 'EUNIS_2018_Shapefile'
});</code></pre>

<p>These outputs can now be used for detailed GIS-based analysis and validation.</p>

<h5><strong>Step 11: Add User Interaction for Drawing Analysis</strong></h5>
<p><strong>Explanation:</strong> Drawing tools allow users to interactively analyze specific areas on the map. The drawn geometry serves as the input for computing EUNIS class areas.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"><code>// Enable drawing tools on the map
var drawingTools = ui.Map.DrawingTools();
drawingTools.setShown(true);
drawingTools.setDrawModes(['polygon']);
Map.add(drawingTools);

// Analyze drawn geometry
drawingTools.onDraw(function(geometry) {
  var eunisAreas = computeEunisAreas(reclassified2018, '2018', geometry);
  print('EUNIS Areas:', eunisAreas);
});</code></pre>

<p>This interactive feature enhances user engagement by allowing custom area analysis.</p>

<h5><strong>Step 12: Create a Legend</strong></h5>
<p><strong>Explanation:</strong> A legend helps users understand the mapping of EUNIS classes to colors. This is essential for interpreting the visualized data accurately.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"><code>// Create a legend panel
var legend = ui.Panel({
  style: { position: 'bottom-left', padding: '8px' }
});
legend.add(ui.Label('EUNIS Habitat Classes'));

Object.keys(eunisNumericMapping).forEach(function(key) {
  legend.add(ui.Panel({
    widgets: [
      ui.Label({
        style: {
          backgroundColor: eunisNumericMapping[key].color,
          padding: '8px',
          margin: '4px'
        }
      }),
      ui.Label(eunisNumericMapping[key].description)
    ],
    layout: ui.Panel.Layout.Flow('horizontal')
  }));
});

Map.add(legend);</code></pre>

<p>Now users can reference the legend to understand the visualized classifications.</p>

<h5><strong>Step 13: Finalize and Share the Workflow</strong></h5>
<p><strong>Explanation:</strong> The completed workflow can now be shared with stakeholders or team members. This step involves documenting the methodology and ensuring all data outputs are correctly exported and stored.</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"><code>// Save the script and export as needed
print('Workflow completed successfully.');</code></pre>

<p>At this stage, the habitat classification workflow is finalized and ready for application.</p>


<h3><strong>Eco-EUNIS Value Map</strong></h3>
<p>
    Understanding habitats requires more than just classification—it is essential to <strong>assess their ecological value</strong> 
    to support <strong>nature-based solutions (NbS), resilience strategies, and conservation planning</strong> 
    (<a href="https://doi.org/10.1016/j.ecoser.2018.10.012" target="_blank">Masiero et al., 2018</a>).  
    The Eco-EUNIS Value Map builds upon <strong>existing EUNIS habitat datasets</strong> but supplements them with <strong>the Flemish Biological Valuation Map (BWK)</strong>, 
    which provides <strong>spatial ecological valuation insights</strong> 
    (<a href="https://oneecosystem.pensoft.net/article/29153/" target="_blank">Burkhard et al., 2018</a>).
</p>

<p>
    Ecological valuation methods have been extensively studied for <strong>biodiversity conservation</strong> and <strong>land-use planning</strong> 
    (<a href="https://www.sciencedirect.com/science/article/pii/S2212041620300243" target="_blank">Tasser et al., 2020</a>).  
    The <strong>European Landscape Convention (ELC)</strong> 
    (<a href="https://www.coe.int/en/web/landscape" target="_blank">Council of Europe, 2000</a>)  
    emphasizes the <strong>need for spatially explicit ecological characterization</strong>. The integration of <strong>habitat mapping</strong> 
    with <strong>valuation frameworks</strong> ensures that planners can prioritize landscapes based on their <strong>functional importance</strong> 
    (<a href="https://link.springer.com/article/10.1007/s13280-017-0922-x" target="_blank">Schröter et al., 2017</a>).
</p>


<h4><strong>Data Sources and Technical Descriptions</strong></h4>
<p>
    The Eco-EUNIS Value Map is created using two primary datasets:
</p>
<ul>
    <li><a href="https://eunis.eea.europa.eu/" target="_blank"><strong>EUNIS Habitat classification</strong></a>:  
        A standardized dataset <strong>classifying European habitats</strong> based on <strong>biophysical, and ecological characteristics</strong>.</li>
    <li><a href="https://www.vlaanderen.be/datavindplaats/catalogus/biologische-waarderingskaart-en-natura-2000-habitatkaart-toestand-2023" target="_blank"><strong>Flemish Biological Valuation Map (BWK)</strong></a>:  
        A high-resolution spatial dataset <strong>mapping biodiversity values</strong> across <strong>Flanders</strong>, offering detailed insights into Natura 2000 habitat types and regionally significant biotopes.</li>
</ul>
<p>
    Thanks to the Flemish Institute for Nature and Forest Research (INBO) and Digital Flanders, we can access an extensive spatial dataset that facilitates <strong>ecological valuation and resilience assessments</strong>. The integration of BWK into Eco-EUNIS enhances our ability to map ecological functions, biodiversity hotspots, and conservation priorities.
</p>

<h4><strong>Metadata Summary</strong></h4>
<table style="border-collapse: collapse; width: 100%; border: 1px solid black;">
    <tr style="background-color: #f2f2f2;">
        <th style="border: 1px solid black; padding: 8px; text-align: left;">Attribute</th>
        <th style="border: 1px solid black; padding: 8px; text-align: left;">Description</th>
    </tr>
    <tr>
        <td style="border: 1px solid black; padding: 8px;">Dataset Name</td>
        <td style="border: 1px solid black; padding: 8px;">Flemish Biological Valuation Map (BWK)</td>
    </tr>
    <tr>
        <td style="border: 1px solid black; padding: 8px;">Version</td>
        <td style="border: 1px solid black; padding: 8px;">BWK2 Version 2.2 - Status 2023</td>
    </tr>
    <tr>
        <td style="border: 1px solid black; padding: 8px;">Geographical Coverage</td>
        <td style="border: 1px solid black; padding: 8px;">Flanders, Belgium</td>
    </tr>
    <tr>
        <td style="border: 1px solid black; padding: 8px;">Spatial Resolution</td>
        <td style="border: 1px solid black; padding: 8px;">1:3000</td>
    </tr>
    <tr>
        <td style="border: 1px solid black; padding: 8px;">Data Owner</td>
        <td style="border: 1px solid black; padding: 8px;">Institute for Nature and Forest Research (INBO)</td>
    </tr>
    <tr>
        <td style="border: 1px solid black; padding: 8px;">Access & Licensing</td>
        <td style="border: 1px solid black; padding: 8px;">Publicly available (Digital Flanders)</td>
    </tr>
</table>

<h4><strong>Ecological Zone Classification</strong></h4>
<ul>
    <li><strong>Biologisch minder waardevol</strong> (Biologically Less Valuable)</li>
    <li><strong>Complex van biologisch minder waardevolle en waardevolle elementen</strong> (Complex of Less Valuable and Valuable Elements)</li>
    <li><strong>Complex van biologisch minder waardevolle, waardevolle en zeer waardevolle elementen</strong> (Complex of Less Valuable, Valuable, and Very Valuable Elements)</li>
    <li><strong>Complex van biologisch minder waardevolle en zeer waardevolle elementen</strong> (Complex of Less Valuable and Very Valuable Elements)</li>
    <li><strong>Biologisch waardevol</strong> (Biologically Valuable)</li>
    <li><strong>Complex van biologisch waardevolle en zeer waardevolle elementen</strong> (Complex of Valuable and Very Valuable Elements)</li>
    <li><strong>Biologisch zeer waardevol</strong> (Biologically Very Valuable)</li>
</ul>
<p>
    These classifications provide a structured approach to <strong>evaluating habitat significance</strong>, ensuring that ecological resilience is factored into <strong>planning and conservation efforts</strong>.
</p>


    <h4><strong>Data Acquisition and Processing</strong></h3>
<p>
        The Eco-EUNIS Value Map aims to integrate **habitat classification with ecological valuation** to support 
        **nature-based solutions (NbS)** and **landscape resilience assessments**. This is achieved by combining 
        **EUNIS habitat data** with the **Flemish Biological Valuation Map (BWK)**.
    </p>

    <h4><strong>Exploring the Dataset Online</strong></h3>
    <p>
        If you want to **explore the dataset interactively**, follow these steps:
    </p>
    <ul>
        <li>Go to <a href="https://www.vlaanderen.be/datavindplaats/catalogus/biologische-waarderingskaart-en-natura-2000-habitatkaart-toestand-2023" target="_blank">this webpage</a>.</li>
        <li>Click on **"Show on Geopunt map"**. The dataset will load.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/16.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
        <li>Zoom in to **5km scale** to see features appear.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/17.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>
        <li>Click the **Layers button** to view legend, turn layers on/off, or access more details.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/18.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>
        <li>To inspect an area, **click on the map**. A panel will appear showing its **ecological value**.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/19.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>
      </ul>
    <p>
        While this approach allows **basic exploration**, it does not enable **integration with EUNIS data**.  
        To perform in-depth analysis, we need to **download the dataset** or use an **API endpoint** in GIS software.
    </p>

    <h4><strong>Downloading the BWK Dataset</strong></h4>
    <p>
        To manually download the dataset:
    </p>
    <ul>
        <li>Go to <a href="https://metadata.vlaanderen.be/srv/dut/catalog.search#/metadata/9fffedd9-5076-4310-a366-198947717725" target="_blank">this metadata page</a>.</li>
        <li>Click **"Download"** and export the files as a ZIP.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/20.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
        <li>Unzip the files. The dataset includes:
          <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/21.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
            <ul>
                <li><strong>BWK 2 Zone</strong>: Main ecological valuation dataset (Shapefile format).</li>
                <li><strong>Habfauna & Hab3260</strong>: Additional datasets for biodiversity assessment.</li>
                <li><strong>Metadata PDF</strong>: Important documentation about the dataset.</li>
            </ul>
        </li>
    </ul>
    <p>
        Before proceeding with GIS analysis, **review the metadata file** to understand the dataset structure.
    </p>

    <h4><strong>Loading the Data into QGIS</strong></h4>
    <p>
        To visualize the dataset in **QGIS**, follow these steps:
    </p>
    <ul>
        <li>Open **QGIS**.</li>
        <li>Go to **Layer → Add Vector Layer**.</li>
        <li>Navigate to the **BWK 2 Zone Shapefile** and click **Open**.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/22.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
        <li>To apply symbology, go to **Layer Properties → Symbology → Load Style**.</li>
        <li>Select the **.lyr or .sld file** included in the ZIP.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/24.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
    </ul>
        
  

    <h4><strong>Loading the Data into ArcGIS Pro</strong></h4>
    <p>
        To visualize the dataset in **ArcGIS Pro**, follow these steps:
    </p>
    <ul>
        <li>Open **ArcGIS Pro**.</li>
        <li>Click **Add Data** and browse to the **BWK 2 Zone Shapefile**.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/23.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        
        <li>Drag and drop the layer onto the **Map panel**.</li>
        <li>Right-click the layer, select **Symbology**, and load the **LYR file**.</li>
    </ul>
    <p><em>Screenshot Placeholder: ArcGIS Pro Symbology Setup</em></p>

    <h4><strong>Accessing the Dataset via API (WFS/WMS)</strong></h4>
    <p>
        Instead of downloading files, you can access the dataset via **API endpoints**:
    </p>
    <ul>
        <li><strong>WMS Endpoint:</strong> <a href="https://www.geopunt.be/catalogus" target="_blank">Geopunt API</a>.</li>
        <li><strong>WFS Endpoint:</strong> <a href="https://metadata.vlaanderen.be/srv/dut/catalog.search#/metadata/9fffedd9-5076-4310-a366-198947717725" target="_blank">Metadata API</a>.</li>
    </ul>
    
    <h5><strong>Steps to Load WMS/WFS in QGIS</strong></h5>
    <ul>
        <li>Go to **Layer → Data Source Manager → WMS/WMTS**.</li>
        <li>Click **"New"** and enter the **WMS API URL**.</li>
        <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/25.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>    
        <li>Load the layers and inspect attributes.</li>
    </ul>
    
    <h5><strong>Steps to Load WMS/WFS in ArcGIS Pro</strong></h5>
    <ul>
        <li>Go to **Insert → Connections → Server → Add WMS Server**.</li>
        <li>Enter the **API endpoint** and add layers to the map.</li>
    </ul>

    <h4><strong>Python Script for Automated Data Download</strong></h4>
    <p>
        The dataset can also be downloaded programmatically using Python:
    </p>
    <pre>
import requests
import geopandas as gpd

# API Endpoint for BWK Data
bwk_api_url = "https://metadata.vlaanderen.be/srv/dut/catalog.search#/metadata/9fffedd9-5076-4310-a366-198947717725"

# Download Data
response = requests.get(bwk_api_url)
if response.status_code == 200:
    with open("BWK_data.zip", "wb") as file:
        file.write(response.content)
    print("Download successful. Extract and load in QGIS/ArcGIS.")
else:
    print("Failed to download data.")
    </pre>

    <h4><strong>Integrating BWK Data with EUNIS Habitat Data</strong></h4>
    <p>
        Now that we have loaded the dataset, the next step is to **integrate it with EUNIS habitat data**.  
        If you downloaded the BWK dataset manually, it is in **vector format**, so ensure that the **EUNIS dataset** is also in the same format.
    </p>

    <h5><strong>Spatial Join for Desktop GIS</strong></h5>
    <p>
        The best method to merge both datasets in **QGIS or ArcGIS** is **spatial join**:
    </p>
    <ul>
        <li>Go to **Vector → Data Management Tools → Join Attributes by Location**.</li>
        <li>Select **EUNIS as the target layer** and **BWK as the join layer**.</li>
        <li>Choose **"intersects"** as the spatial operation.</li>
        <li>Export the result as a **new dataset**.</li>
    </ul>
    <div style="background-color: #e6f2ff; padding: 15px; border-radius: 5px; border-left: 5px solid #008cba;">
      <strong>Note</strong>
      <p>We <strong>do not cover this spatial operation in this guide</strong> since we want to do this in a cloud computing environment. If you want to do this you can consult other resources on how to perform a spatial join.</p>
    </div>
    <h5><strong>Cloud-Based Integration (Google Earth Engine)</strong></h5>
    <p>
        Given the **large file size** (100,000+ polygons), **cloud processing** is preferable.  
        We will **upload the BWK dataset to Earth Engine** and use it alongside the **EUNIS dataset stored as an asset**.
    </p>



    <h4><strong>Step 1: Load Existing EUNIS & BWK Data</strong></h3>
    <p>
        Before performing any spatial analysis, we need to **load the required datasets into Google Earth Engine (GEE)**.  
        This includes:
    </p>
    <ul>
        <li><strong>EUNIS Habitat Classification (Raster)</strong>: A processed habitat dataset for the year 2018.</li>
        <li><strong>BWK Ecological Valuation (Vector)</strong>: A dataset containing **ecological quality ratings** for land units.</li>
        <li><strong>Study Region (West Flanders, Belgium)</strong>: The bounding box coordinates for our analysis.</li>
    </ul>

  
    <p>
        Combining these datasets will allow us to assess the **ecological value of different EUNIS habitat types**.  
        However, we first need to:
    </p>
    <ul>
        <li>Check that the **EUNIS raster contains the correct bands**.</li>
        <li>Inspect the **BWK vector attributes** before further processing.</li>
        <li>Define a **Region of Interest (ROI)** for analysis.</li>
    </ul>

    
    <p>
        The following script loads the datasets and prints basic information for validation:
    </p>

    <pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">// Create a legend panel
// ===============================
// **LOAD EXISTING EUNIS & BWK DATA**
// ===============================

// Load the EUNIS habitat raster dataset (processed version)
var eunis = ee.Image("projects/ee-desmond/assets/EUNIS_2018_TIFF_nbracer");

// Load the BWK ecological valuation shapefile
var bwk = ee.FeatureCollection("projects/ee-desmond/assets/BwkHab");

// Define the region of interest (West Flanders, Belgium)
var region = ee.Geometry.BBox(2.5, 50.7, 4.0, 51.4);

// ===============================
// **DEBUGGING: PRINT AVAILABLE PROPERTIES & BANDS**
// ===============================

print(" EUNIS Image Properties:", eunis);
print("EUNIS Image Bands:", eunis.bandNames());  // Ensure correct band names
print(" BWK First Feature:", bwk.first());  // Inspect BWK structure
    
</pre>

    
      <p>
          - The script **imports EUNIS** as a raster image and **BWK as a feature collection**.  
          - The study area is defined as a **bounding box (BBox)** for the West Flanders region.  
          - The **<code>print()</code> function** helps inspect the datasets to ensure correctness before proceeding.  
      </p>

      <h4><strong>Expected Output</strong></h4>
      <p>
          When you run the script in **Google Earth Engine**, you should see:
      </p>
      <ul>
          <li>A **list of bands** available in the **EUNIS raster**.</li>
          <li>The **first feature** in the **BWK dataset**, showing its attribute fields.</li>
          <li>A **geometry object** defining the West Flanders region.</li>
      </ul>

      <p><em>(Insert screenshot of GEE console output here)</em></p>

  <h4><strong>Next Step</strong></h4>
  <p>
      Now that we have successfully loaded the datasets, the next step is to **convert BWK ecological categories into numeric values**  
      so they can be used in geospatial calculations.
  </p>


  
      <h4><strong>Step 2: Convert BWK 'EVAL' Property to Numeric Values</strong></h3>
      
<p>
  The **BWK dataset** contains an attribute named **EVAL**, which assigns qualitative ecological values  
  to land areas. However, these values are stored as **categorical text**, which is not suitable for raster  
  calculations or spatial analysis. We need to **map these categories to numerical values**.
</p>


<ul>
    <li>**Raster datasets require numeric values** for classification and analysis.</li>
    <li>**Mathematical operations (e.g., reclassification, merging) need numeric data types**.</li>
    <li>**Ensures compatibility** between the BWK (vector) and EUNIS (raster) datasets.</li>
</ul>

<h4><strong>Ecological Value Mapping Scheme</strong></h4>
<p>
    We will **map the BWK categorical values to numerical equivalents** as follows:
</p>

<table border="1">
    <tr>
        <th>Categorical Value (EVAL)</th>
        <th>Numerical Value (EVAL_NUM)</th>
        <th>Ecological Meaning</th>
    </tr>
    <tr>
        <td>z</td>
        <td>7</td>
        <td>Very High</td>
    </tr>
    <tr>
        <td>wz</td>
        <td>6</td>
        <td>High</td>
    </tr>
    <tr>
        <td>w</td>
        <td>5</td>
        <td>Moderate</td>
    </tr>
    <tr>
        <td>mwz</td>
        <td>4</td>
        <td>Low-Moderate</td>
    </tr>
    <tr>
        <td>mw</td>
        <td>3</td>
        <td>Low</td>
    </tr>
    <tr>
        <td>m</td>
        <td>2</td>
        <td>Very Low</td>
    </tr>
    <tr>
        <td>Missing / Undefined</td>
        <td>1</td>
        <td>Unknown</td>
    </tr>
</table>


<p>
    The following script **applies the mapping function to the BWK dataset**:
</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
// ===============================
// **STEP 2: CONVERT BWK 'EVAL' PROPERTY TO NUMERIC**
// ===============================

// Define mapping of categorical BWK values to numeric scores
var bwkCategoryToNumeric = {
'z': 7,  // Very High
'wz': 6, // High
'w': 5,  // Moderate
'mwz': 4, // Low-Moderate
'mw': 3,  // Low
'm': 2    // Very Low
};

// Function to apply the mapping to BWK features
var bwkNumeric = bwk.map(function(feature) {
var evalValue = feature.get('EVAL');  // Get categorical value
var numericValue = ee.Number(ee.Dictionary(bwkCategoryToNumeric).get(evalValue, 1)); // Default to 1 if missing
return feature.set('EVAL_NUM', numericValue);
});

// Debugging Print: Sample BWK Feature with Numeric Values
print("BWK First Feature with Numeric 'EVAL_NUM':", bwkNumeric.first());
</pre>


<ul>
    <li><strong>Dictionary Mapping (bwkCategoryToNumeric)</strong>:
        - This object defines **how text-based values ('z', 'wz', etc.) map to numeric values (7, 6, etc.)**.</li>
    <li><strong><code>bwk.map(function(feature) {...})</code></strong>:  
        - This function **iterates through each feature in the BWK dataset**, applying the numeric mapping.</li>
    <li><strong><code>feature.get('EVAL')</code></strong>:  
        - Retrieves the **existing categorical value** for each BWK feature.</li>
    <li><strong><code>ee.Number(ee.Dictionary(bwkCategoryToNumeric).get(evalValue, 1))</code></strong>:  
        - Converts the **text value into a number** using the dictionary.  
        - If no match is found, it **assigns a default value of 1 (Unknown).**</li>
    <li><strong><code>feature.set('EVAL_NUM', numericValue)</code></strong>:  
        - Adds the new **numeric attribute (EVAL_NUM)** to each feature.</li>
</ul>

<p>
    After running the script, the **first feature in the BWK dataset** should now have a new property:
</p>

<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
Feature {
geometry: (Polygon)
properties: {
    EVAL: "w",
    EVAL_NUM: 5  // Now in numeric format
}
}
</pre>


<p><em>(Insert screenshot of the updated BWK feature table in GEE here)</em></p>

<h4><strong>Next Step</strong></h4>
<p>
    Now that the **BWK dataset has numeric values**, we can proceed to the next step:
    **Rasterizing BWK to match the EUNIS resolution**.
</p>



    <h4><strong>Step 3: Rasterizing BWK to Match EUNIS Resolution</strong></h3>
    
    <p>
        The **BWK dataset** is currently in **vector format**, meaning it consists of **polygon geometries**  
        representing different ecological valuation zones. However, to analyze this data alongside the **EUNIS  
        habitat raster dataset**, we need to **convert BWK into a raster format**. This process is called **rasterization**.
    </p>

    <h4><strong>Why Is Rasterization Important?</strong></h4>
    <ul>
        <li>**Raster data allows pixel-based spatial analysis**, making computations easier and faster.</li>
        <li>**Ensures compatibility with the EUNIS dataset**, which is already in raster format.</li>
        <li>**Reduces processing complexity** when performing operations like overlays and classifications.</li>
    </ul>

    
    <p>
        The following script converts the **BWK ecological value polygons** into a raster, using the  
        **EVAL_NUM field** (which we created in Step 2).
    </p>

    <pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
// ===============================
// **STEP 3: RASTERIZE BWK TO MATCH EUNIS RESOLUTION**
// ===============================

// Convert BWK features to raster using the 'EVAL_NUM' property
var bwkValues = bwkNumeric.reduceToImage({
  properties: ['EVAL_NUM'],  
  reducer: ee.Reducer.first()  // Assigns first valid value per pixel
}).rename('ecological_value');

// Debugging Print: Rasterized BWK Values
print(" Rasterized BWK Values (ecological_value):", bwkValues);

// Align BWK raster to match EUNIS spatial resolution
bwkValues = bwkValues.reproject({
  crs: eunis.projection(),  // Use EUNIS coordinate reference system
  scale: eunis.projection().nominalScale()  // Match pixel size
});

print(" Reprojected BWK Raster:", bwkValues);
    </pre>

    
    <ul>
        <li><strong><code>bwkNumeric.reduceToImage()</code></strong>:  
            - Converts the **BWK vector polygons into a raster** using the **EVAL_NUM** field.  
            - Uses **<code>ee.Reducer.first()</code>** to assign the first encountered value to each pixel.</li>
        <li><strong><code>.rename('ecological_value')</code></strong>:  
            - Gives the new raster band a **meaningful name (ecological_value)**.</li>
        <li><strong><code>bwkValues.reproject()</code></strong>:  
            - Ensures the **BWK raster has the same coordinate reference system (CRS) and resolution as EUNIS**.</li>
        <li><strong><code>eunis.projection()</code></strong>:  
            - Retrieves the **projection system of the EUNIS dataset**, ensuring alignment.</li>
        <li><strong><code>eunis.projection().nominalScale()</code></strong>:  
            - Ensures the **BWK raster uses the same pixel size** as EUNIS.</li>
    </ul>

    <h4><strong>Expected Output</strong></h4>
    <p>
        After running the script, BWK should be successfully **converted into a raster**.  
        The raster should now have an **ecological_value** band, where each pixel represents an  
        ecological valuation score.
    </p>

    <pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
Raster Properties:
- Band Name: ecological_value
- Pixel Size: Matches EUNIS raster
- Projection: EPSG:4326
- Data Type: Integer (1-7)
    </pre>

    
    <p><em>(Insert screenshot of the BWK raster output in GEE here)</em></p>

    <h4><strong>Next Step</strong></h4>
    <p>
        Now that the **BWK dataset is rasterized**, we can move to the next step:
        **Combining the BWK raster with the EUNIS habitat raster.**
    </p>

    
    
        <h4><strong>Step 4: Exporting the BWK Dataset for Crosswalk Analysis</strong></h3>
    
        <p>
            Now that we have **merged the EUNIS habitat dataset with BWK ecological values**,  
            the next step is to **export the BWK dataset as a raster asset** in Google Earth Engine.  
        </p>
    
        <h4><strong>Why Do We Need to Export the BWK Dataset?</strong></h4>
        <ul>
            <li>🔹 **Converting BWK from a feature collection to raster** ensures compatibility with raster-based analysis.</li>
            <li>🔹 This raster will serve as the **foundation for crosswalk analysis**, where we compare **EUNIS habitat types** with **BWK ecological values**.</li>
            <li>🔹 Exporting the dataset allows **efficient spatial sampling**, avoiding excessive processing load.</li>
        </ul>
    
        
        <p>
            The following script exports the **BWK raster dataset** so that it can be later  
            used for **sampling and crosswalk table generation**.
        </p>
    
        <pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
    // ===============================
    // **STEP 4: EXPORT BWK DATASET AS A RASTER**
    // ===============================
    
    // Export BWK dataset as a raster asset in Google Earth Engine
    Export.image.toAsset({
      image: eunisWithBwk,
      description: 'EUNIS_BWK_EcoValue_TIFF',
      assetId: 'projects/ee-desmond/assets/EUNIS_BWK_EcoValue_TIFF',
      region: region,
      scale: 100,
      crs: 'EPSG:4326',
      maxPixels: 1e13
    });
        </pre>
    
        
        <ul>
            <li><strong><code>Export.image.toAsset()</code></strong>:  
                - Saves the **BWK raster dataset** as an **Earth Engine asset** for later use.</li>
            <li><strong><code>image: eunisWithBwk</code></strong>:  
                - Specifies that we are exporting **EUNIS with BWK values merged**.</li>
            <li><strong><code>region: region</code></strong>:  
                - Defines the **study area (West Flanders, Belgium)**.</li>
            <li><strong><code>scale: 100</code></strong>:  
                - Ensures that the **raster resolution** is **100 meters per pixel**.</li>
            <li><strong><code>crs: 'EPSG:4326'</code></strong>:  
                - Ensures a **consistent spatial reference system** (WGS84).</li>
            <li><strong><code>maxPixels: 1e13</code></strong>:  
                - Ensures the dataset can be processed without exceeding Earth Engine’s limits.</li>
        </ul>
    
        <h4><strong>Expected Output</strong></h4>
        <p>
            After running this export command, you should find the **EUNIS_BWK_EcoValue_TIFF**  
            stored under **"Assets" in Google Earth Engine**.
        </p>
        <pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
        projects/ee-desmond/assets/EUNIS_BWK_EcoValue_TIFF
        </pre>
    
        
        <p><em>(Insert screenshot of Google Earth Engine asset manager with the exported dataset here)</em></p>
    
        <h4><strong>Next Step: Performing the Crosswalk Analysis</strong></h4>
        <p>
            With the **BWK dataset now available in raster format**,  
            we can proceed to **Step 5**, where we will extract **random sample points**  
            and generate a **crosswalk table** comparing **habitat types with ecological values**.
        </p>


        
            <h4><strong>Step 5: Generating a Crosswalk Table</strong></h3>
        
            <p>
                Now that we have the **EUNIS habitat** and **BWK ecological valuation** datasets  
                stored as a raster asset, we can proceed with generating a **crosswalk table**  
                that maps **habitat types to their ecological valuation**.
            </p>
        
            <h4><strong>Why is a Crosswalk Table Important?</strong></h4>
            <ul>
                <li> Helps **quantify** the ecological value of different land cover types.</li>
                <li> Allows for **comparative analysis** of habitat resilience and biodiversity.</li>
                <li> Supports **nature-based solutions (NbS)** planning for climate adaptation.</li>
                <li> Provides structured data that can be used in **spatial modeling**.</li>
            </ul>
        
            
            <p>
                The following script **samples raster values** at randomly generated locations  
                and creates a **crosswalk table linking habitat types to their ecological value**.
            </p>
        
<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
// ===============================
// **STEP 5: CROSSWALK TABLE GENERATION**
// ===============================

//  Load the updated raster dataset with EUNIS + BWK data
var eunisWithBwkUpdated = ee.Image("projects/ee-desmond/assets/EUNIS_BWK_EcoValue_TIFF");
print(" Loaded Final Raster for Crosswalk Table Generation:", eunisWithBwkUpdated);

//  Extract EUNIS and Ecological Value bands
var eunisBand = eunisWithBwkUpdated.select('eunis');
var ecoValueBand = eunisWithBwkUpdated.select('ecological_group');
print(" EUNIS Band:", eunisBand);
print(" Ecological Value Band:", ecoValueBand);

//  Generate Random Sample Points within the Study Region
var samplePoints = ee.FeatureCollection.randomPoints({
region: region, 
points: 5000, // Limit to avoid exceeding feature count
seed: 42
});
print(" Generated Sample Points:", samplePoints);

//  Extract EUNIS and Ecological Values at Sampled Locations
var sampledValues = eunisWithBwkUpdated.sampleRegions({
collection: samplePoints,
scale: 100,
properties: [],
tileScale: 4  // Optimized for large collections
});
print(" Sampled Raster Values:", sampledValues.limit(10)); // Preview first 10 rows

//  Convert Sampled Data into a Feature Collection Table
var eunisMapping = ee.Dictionary(eunisNumericMapping); // Convert to EE dictionary

var crosswalkTable = sampledValues.map(function(feature) {
var eunisClass = feature.get('eunis');  // Extract EUNIS class ID
var ecoValue = feature.get('ecological_group'); // Extract Ecological Value

// Convert EUNIS class to a string key for dictionary lookup
var eunisKey = ee.Algorithms.If(eunisClass, ee.String(eunisClass), 'Unknown');

// Ensure the key exists in the dictionary, else assign default values
var hasKey = eunisMapping.contains(eunisKey);

var eunisEntry = ee.Algorithms.If(
hasKey, 
eunisMapping.get(eunisKey), 
ee.Dictionary({'eunisCode': 'Unknown', 'description': 'Unknown Habitat', 'color': '#808080'})
);

var eunisCode = ee.String(ee.Dictionary(eunisEntry).get('eunisCode'));
var eunisDesc = ee.String(ee.Dictionary(eunisEntry).get('description'));
var eunisColor = ee.String(ee.Dictionary(eunisEntry).get('color'));

return feature.set({
'EUNIS Code': eunisCode,
'EUNIS Habitat': eunisDesc,
'EUNIS Color': eunisColor,
'Ecological Value': ecoValue
});
});

//  Convert to Feature Collection for Table View
var crosswalkFC = ee.FeatureCollection(crosswalkTable);
print(" Final Crosswalk Table (Sampled Pixels):", crosswalkFC.limit(10)); // Preview first 10 rows

//  Export as a CSV for non-GIS users
Export.table.toDrive({
collection: crosswalkFC,
description: 'EUNIS_Ecological_Crosswalk_Sampled',
fileFormat: 'CSV'
});
print(" Export Task Created: Run it manually in the 'Tasks' tab!");
</pre>


<ul>
    <li><strong><code>sampleRegions()</code></strong>:  
        - Extracts **EUNIS habitat type** and **BWK ecological value** at **random points**.</li>
    <li><strong><code>randomPoints()</code></strong>:  
        - Generates **5000 random sample locations** across the study area.</li>
    <li><strong><code>map()</code></strong>:  
        - Iterates through each sampled location, **retrieving habitat and ecological value**.</li>
    <li><strong><code>Export.table.toDrive()</code></strong>:  
        - Exports the **final crosswalk table** as a **CSV file**.</li>
</ul>

<h4><strong>Expected Output</strong></h4>
<p>
    After running this script, you will find a **crosswalk table**  
    available in Google Drive as a **CSV file**, which links:
</p>
<pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
EUNIS Habitat Type → BWK Ecological Value
----------------------------------------
Forest (T1)        → Very High (7)
Urban Area (J1)    → Low (2)
Wetland (C1)       → High (6)
</pre>


<p><em>(Insert screenshot of exported crosswalk CSV file here)</em></p>

<h4><strong>Next Step: Visualizing the Data</strong></h4>
<p>
    With the **crosswalk table completed**,  
    we will move to **Step 6**, where we visualize the dataset  
    and interpret key insights from the analysis on the map canvas.
</p>

    <h4><strong>Step 6: Map Visualization</strong></h3>

    <p>
        With the **crosswalk table** completed, we can now visualize  
        the EUNIS habitat types and BWK ecological valuation data  
        in Google Earth Engine.
    </p>

    
    <ul>
        <li> Helps **identify spatial patterns** in ecological value.</li>
        <li> Supports **policy-making and conservation planning**.</li>
        <li> Allows for **interactive exploration of habitat quality**.</li>
    </ul>

    
    <p>
        The following script **renders an interactive map**  
        with a **legend showing ecological value classifications**.
    </p>

    <pre style="background-color: #e6ffe6; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
// ===============================
// **STEP 6: MAP VISUALIZATION**
// ===============================

var eunisNumericMapping = {
  1: {eunisCode: 'J1', color: '#b22222', description: 'Buildings of cities, towns, and villages'}, // Deep red for urban areas
  2: {eunisCode: 'J1.2', color: '#ff4500', description: 'Residential buildings of villages and urban peripheries'}, // Orange-red
  3: {eunisCode: 'J2', color: '#ffa07a', description: 'Low density buildings'}, // Light coral for suburban areas
  4: {eunisCode: 'J4', color: '#8b4513', description: 'Transport networks and other hard-surfaced areas'}, // Saddle brown for roads
  5: {eunisCode: 'J4.5', color: '#d2691e', description: 'Hard-surfaced areas of ports'}, // Chocolate brown
  6: {eunisCode: 'J4.4', color: '#808080', description: 'Airport runways and aprons'}, // Gray for airstrips
  7: {eunisCode: 'J3', color: '#556b2f', description: 'Extractive industrial sites'}, // Dark olive green for industrial land
  8: {eunisCode: 'J6', color: '#a0522d', description: 'Waste deposits'}, // Sienna for waste areas
  9: {eunisCode: 'J1.6', color: '#d2b48c', description: 'Urban and suburban construction and demolition sites'}, // Tan
  10: {eunisCode: 'J2.6-2012', color: '#deb887', description: 'Disused rural constructions'}, // Burlywood
  11: {eunisCode: 'E2.6-2012', color: '#32cd32', description: 'Heavily fertilised grassland, including sports fields and grass lawns'}, // Lime green for managed grass
  12: {eunisCode: 'I1.1', color: '#adff2f', description: 'Intensive unmixed crops'}, // Green-yellow for intensive crops
  13: {eunisCode: 'J2.43-2012', color: '#ff7f50', description: 'Greenhouses'}, // Coral for greenhouses
  14: {eunisCode: 'V5', color: '#8fbc8f', description: 'Shrub plantations'}, // Dark sea green for shrubs
  15: {eunisCode: 'T24', color: '#228b22', description: 'Olea europaea-Ceratonia siliqua forest'}, // Forest green
  16: {eunisCode: 'B15', color: '#f4a460', description: 'Bare tilled, fallow or recently abandoned arable land'}, // Sandy brown
  17: {eunisCode: 'V12', color: '#ffe4b5', description: 'Mixed crops of market gardens and horticulture'}, // Moccasin
  18: {eunisCode: 'V13', color: '#f0e68c', description: 'Arable land with unmixed crops grown by low-intensity agricultural methods'}, // Khaki
  19: {eunisCode: 'V6', color: '#6b8e23', description: 'Tree dominated man-made habitats'}, // Olive drab
  20: {eunisCode: 'T1', color: '#008000', description: 'Deciduous broadleaved forest'}, // Green for forest
  21: {eunisCode: 'T29', color: '#2e8b57', description: 'Broadleaved evergreen plantation of non site-native trees'}, // Sea green
  22: {eunisCode: 'V14', color: '#f2cca6', description: 'Agro-forestry areas'}, // Sandy orange for CORINE class 244
  23: {eunisCode: 'T3', color: '#3cb371', description: 'Coniferous forest'}, // Medium sea green
  24: {eunisCode: 'T3N', color: '#66cdaa', description: 'Coniferous plantation of site-native trees'}, // Medium aquamarine
  25: {eunisCode: 'G4-2012', color: '#20b2aa', description: 'Mixed deciduous and coniferous woodland'}, // Light sea green
  26: {eunisCode: 'G4.F-2012', color: '#5f9ea0', description: 'Mixed forestry plantations'}, // Cadet blue
  27: {eunisCode: 'T41', color: '#4682b4', description: 'Early-stage natural and semi-natural forest and regrowth'}, // Steel blue
  28: {eunisCode: 'T42', color: '#87cefa', description: 'Early-stage natural and semi-natural forest and regrowth'}, // Light sky blue
  29: {eunisCode: 'T43', color: '#d3d3d3', description: 'Recently felled areas'}, // Light gray
  30: {eunisCode: 'V3', color: '#7cfc00', description: 'Artificial grasslands and herb dominated habitats'}, // Lawn green
  31: {eunisCode: 'R2', color: '#006400', description: 'Mesic grasslands'}, // Dark green
  32: {eunisCode: 'R4', color: '#556b2f', description: 'Alpine and subalpine grasslands'}, // Dark olive green
  33: {eunisCode: 'S4', color: '#8b0000', description: 'Temperate shrub heathland'}, // Dark red
  34: {eunisCode: 'F5', color: '#b0c4de', description: 'Maquis, arborescent matorral, and thermo-Mediterranean brushes'}, // Light steel blue
  35: {eunisCode: 'U2', color: '#708090', description: 'Screes'}, // Slate gray
  36: {eunisCode: 'N1', color: '#fa8072', description: 'Coastal dunes and sandy shores'}, // Salmon
  37: {eunisCode: 'C3.6-2012', color: '#add8e6', description: 'Sparsely vegetated shores'}, // Light blue
  38: {eunisCode: 'C2', color: '#4169e1', description: 'Surface running waters'}, // Royal blue
  39: {eunisCode: 'C1', color: '#00bfff', description: 'Surface standing waters'}, // Deep sky blue
  40: {eunisCode: 'MA2', color: '#6495ed', description: 'Littoral biogenic habitat'}, // Cornflower blue
  41: {eunisCode: 'J5.1', color: '#1e90ff', description: 'Highly artificial saline and brackish waters'}, // Dodger blue
  42: {eunisCode: 'MA5', color: '#ffdab9', description: 'Littoral sand'}, // Peach puff
  43: {eunisCode: 'X02-2012', color: '#87ceeb', description: 'Saline coastal lagoons'}, // Sky blue
  44: {eunisCode: 'X01', color: '#2171b5', description: 'Estuaries'} // Dark blue
};

// Define visualization parameters for EUNIS habitats
var eunisVisParams = {
  min: 1,
  max: 44,
  palette: Object.keys(eunisNumericMapping).map(function(key) {
    return eunisNumericMapping[key].color;
  })
};

// Print available bands in the final raster before visualization
print(" Final Raster Bands:", eunisWithBwk.bandNames());

// Define visualization parameters for the 7-group classification
var visParams = {
  min: 2,  // Change from 1 to 2
  max: 7,
  palette: ['#edf8fb', '#ccece6', '#99d8c9', '#66c2a4', '#41ae76', '#238b45'] // Correct order
};



// Load the processed EUNIS raster with ecological values
var eunisEcoValue = ee.Image("projects/ee-desmond/assets/EUNIS_BWK_EcoValue_TIFF");
print(" Loaded Final Raster for Visualization:", eunisEcoValue);

// Center the map on the study region
Map.centerObject(region, 10);

// Add the ecological classification layer
Map.addLayer(eunisEcoValue.select('ecological_group'), visParams, "Ecological Value Classification");

// **🔹 Add the Legend**
var legend = ui.Panel({
  style: {
    position: 'bottom-left',
    padding: '8px',
    backgroundColor: 'white'
  }
});

// Add title to the legend
legend.add(ui.Label({
  value: 'Ecological Value Classification',
  style: { fontWeight: 'bold' }
}));

// Correct classification labels matching raster values (2 to 7)
var labels = ['Very Low', 'Low', 'Low-Moderate', 'Moderate', 'High', 'Very High'];
var colors = ['#edf8fb', '#ccece6', '#99d8c9', '#66c2a4', '#41ae76', '#238b45'];  // Matches visParams

// Clear previous legend (if any)
var legend = ui.Panel({
  style: {
    position: 'bottom-left',
    padding: '8px',
    backgroundColor: 'white'
  }
});

// Add title
legend.add(ui.Label({
  value: 'Ecological Value Classification',
  style: { fontWeight: 'bold' }
}));

// Add legend entries dynamically (matching raster values)
labels.forEach(function(label, index) {
  legend.add(ui.Panel([
    ui.Label({
      style: {
        backgroundColor: colors[index], 
        padding: '8px', 
        margin: '0px 4px 4px 0', 
        border: '1px solid black'
      }
    }),
    ui.Label({ 
      value: label, 
      style: { margin: '0px 0px 4px 6px' } 
    })
  ], ui.Panel.Layout.Flow('horizontal')));
});

// Add the corrected legend to the map
Map.add(legend);
print(" Legend updated and added to the map.");

// Add EUNIS habitat map to the display
Map.centerObject(region, 10);
Map.addLayer(eunis, eunisVisParams, "EUNIS Habitat Classification");
    </pre>

    
    <ul>
        <li><strong><code>Map.addLayer()</code></strong>:  
            - Displays the **ecological valuation layer** on the map.</li>
        <li><strong><code>ui.Panel()</code></strong>:  
            - Creates an **interactive legend** for visualization.</li>
        <li><strong><code>palette</code></strong>:  
            - Assigns **colors** to different ecological value classes.</li>
    </ul>

    <h4><strong>Expected Output</strong></h4>
    <p>
        After running this script, the map will display:
    </p>
    <ul>
        <li> **EUNIS habitat classifications** (colored by land cover type).</li>
        <li> **BWK ecological valuation classes** (ranging from very high to very low).</li>
        <li> **An interactive legend** showing the color scheme for each category.</li>
    </ul>

    
    <p style="border-left: 5px solid #ccc; padding-left: 10px;"><img src="https://raw.githubusercontent.com/deltares-desirmed/nbs-workflow/main/img/26.png" alt="Inspecting Data in QGIS" style="display: block; margin: auto; box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);" /></p>        


    <p>
        We can now better understand  
        how different habitats contribute to resilience, biodiversity,  
        and nature-based solutions based on their ecological value. Note that this map is based on the Flemish data. If your region has an ecological value dataset, you can follow and implement similar approach.
    </p>


<div class="giscus"></div>                                         
<script src="https://giscus.app/client.js"
        data-repo="deltares-desirmed/nbs-workflow"
        data-repo-id="R_kgDONtj5VQ"
        data-category="Announcements"
        data-category-id="DIC_kwDONtj5Vc4CmuiS"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>




<!--<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.4.0 (2024-04-24 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Matrix products: default


locale:
[1] LC_COLLATE=English_Germany.utf8  LC_CTYPE=English_Germany.utf8   
[3] LC_MONETARY=English_Germany.utf8 LC_NUMERIC=C                    
[5] LC_TIME=English_Germany.utf8    

time zone: Europe/Berlin
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] terra_1.8-5     sf_1.0-19       workflowr_1.7.1

loaded via a namespace (and not attached):
 [1] jsonlite_1.8.8     highr_0.11         compiler_4.4.0     promises_1.3.0    
 [5] Rcpp_1.0.13        stringr_1.5.1      git2r_0.33.0       callr_3.7.6       
 [9] later_1.3.2        jquerylib_0.1.4    yaml_2.3.10        fastmap_1.2.0     
[13] R6_2.5.1           classInt_0.4-10    knitr_1.48         tibble_3.2.1      
[17] units_0.8-5        rprojroot_2.0.4    DBI_1.2.3          bslib_0.8.0       
[21] pillar_1.9.0       rlang_1.1.4        utf8_1.2.4         cachem_1.1.0      
[25] stringi_1.8.4      httpuv_1.6.15      xfun_0.47          getPass_0.2-4     
[29] fs_1.6.4           sass_0.4.9         cli_3.6.3          magrittr_2.0.3    
[33] class_7.3-22       ps_1.8.1           grid_4.4.0         digest_0.6.36     
[37] processx_3.8.4     rstudioapi_0.16.0  lifecycle_1.0.4    vctrs_0.6.5       
[41] KernSmooth_2.23-22 proxy_0.4-27       evaluate_0.24.0    glue_1.7.0        
[45] whisker_0.4.1      codetools_0.2-20   e1071_1.7-16       fansi_1.0.6       
[49] rmarkdown_2.28     httr_1.4.7         tools_4.4.0        pkgconfig_2.0.3   
[53] htmltools_0.5.8.1 </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


 Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


